# Main Takeaway

数字图像处理与计算机视觉

![image-20250219213332927](assets/数字图像处理Lec1_7.assets/image-20250219213332927.png)

![image-20250219213414079](assets/数字图像处理Lec1_7.assets/image-20250219213414079.png)

![image-20250219213429026](assets/数字图像处理Lec1_7.assets/image-20250219213429026.png)



<!--more-->



# Lec 1 Intro

- 数字图像处理的基本步骤

  ![image-20250219214052867](assets/数字图像处理Lec1_7.assets/image-20250219214052867.png)


- 图像：模拟图像，数字图像


- 将一副图像从模拟状态转变为数字化形式的三个处理过程

  1. 扫描scanning，$m\times n$是空间分辨率，对模拟图像进行寻址，每个被寻址的最小单元最终形成数字图像的一个像素(相当于XY平面采样量化)
  1. 采样sampling：在每个扫描位置测定其灰度值
  1. 量化quantization：将灰度数值划分为不同的等级并对像素地址及量化后的像素灰度等级值进行编码形成离散的二进制序列


- 图像处理系统组成

  ![image-20250227103051203](assets/数字图像处理Lec1_7.assets/image-20250227103051203.png)

  - 图像传感器：获取数字图像 = 物理传感器+数字化仪

  - 专用图像处理硬件：又称前端子系统

    通常由数字化仪和执行其他原始操作的硬件如算术逻辑单元(ALU)组成， 算术逻辑单元对整个图像并行执行算术与逻辑运算。ALU可以进行图像平均操作， 以降低噪声

    显著特点是速度快， 该单元执行要求快速数据吞吐的功能

  - 计算机

  - 图像处理软件

  - 大容量储存

  - 图像显示器

  - 硬拷贝：用于记录图像

    硬拷贝设备包括激光打印机、 胶片相机、 热敏设备、 喷墨设备和数字单元（如CDROM等）。胶片的分辨率最高，但纸质是首选的书写材料


- 数字图像处理的研究领域
  - 数字图像处理过程是对原始图像的数学函数$f(x, y)$进行某种运算H从而得到目标G的过程，这个过程可以表示为：$G = H[f(x, y)]$
  - 根据H性质和目标的不同，可以分为
    - 图像增强(image enhancement)
    - 图像压缩(image compression)
    - 图像恢复(image restoration)
    - 图像特征提取(feature extraction)



# Lec 2 光学成像 传感器与相机



## 人体视觉感知

- 主观亮度是进入人眼光强的**对数函数**  

- 视觉系统分为明视觉和暗视觉

  - **明视觉**是在明亮环境下，由**锥状细胞**主导，具有丰富的色感，能够感知细节和颜色

  - **暗视觉**是在低照度下，由**杆状细胞**主导，能够感受到极弱的光，但物体看上去是灰色的，无法分辨颜色

- 马赫带效应

  视觉系统往往会在不同灰度区域的边界处出现“下冲”或”上冲”现象。右图显示了这种现象的一个典型例子。虽然条带的灰度恒定[图（b)，但在靠近边界的位置我们实际上感知到了带有毛边的明亮模式[图(c)]。这些带有毛边的条带称为马赫带

  <img src="./assets/%E6%95%B0%E5%AD%97%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E2%80%94%E2%80%94%E5%85%89%E5%AD%A6%E6%88%90%E5%83%8F%E4%BC%A0%E6%84%9F%E5%99%A8%E4%B8%8E%E7%9B%B8%E6%9C%BA.assets/image-20250609232924708.png" alt="image-20250609232924708" style="zoom: 67%;" />

- 光学错视

## 照相机历史



## 相机成像原理*

小孔成像，加透镜

- 焦点：与光轴平行的光线射入凸透镜时，理想的镜头应该是所有的光线聚集在一点后，再以锥状的扩散开来，这个聚集所有光线的一点，就叫做焦点
- 弥散圆：在焦点前后，光线开始聚集和扩散，点的影象变成模糊的，形成一个扩大的圆，这个圆就叫做弥散圆。
- 景深(depth of field)：在焦点前后各有一个容许弥散圆，这两个弥散圆之间的距离就叫景深，即：在被摄主体(对焦点)前后，其影像仍然有一段清晰范围的，就是景深——物体近似聚焦的范围
- 焦距：焦距是指无限远的景物在焦平面结成清晰影像时，透镜的第二节点至焦平面的垂直距离
- 视角(field of view)：视角大是指能近距离摄取范围较大的景物；视角小意味着能远距离摄取较大的影像比率。

相互之间的关系：

- 光圈与景深：较小的光圈可以增加物体景深。光圈越大，光通量越大，亮度越大，景深越小，表现为背景虚化
- 焦距与视角：焦距短，视角大；焦距长，视角小
- 焦距与景深：焦距与景深成反比，焦距短，景深大；焦距长，景深小



## 图像传感器**

阵列传感器（CCD、 CMOS）

- CCD（Charge Coupled Device， 电荷耦合器件）
  
  ![image-20250620070631946](./assets/%E6%95%B0%E5%AD%97%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E2%80%94%E2%80%94%E5%85%89%E5%AD%A6%E6%88%90%E5%83%8F%E4%BC%A0%E6%84%9F%E5%99%A8%E4%B8%8E%E7%9B%B8%E6%9C%BA.assets/image-20250620070631946.png)
  
  - CCD上包含的像素数越多， 其画面分辨率越高
  
  - 应用：单反相机（单透镜反光SLR），旁轴相机（取景光轴位于摄影镜头光轴旁边，而且彼此平行， 因而取名“旁轴” 相机）
  
  - 组成：CCD组成主要由一个类似马赛克的网格、 聚光镜片以及垫于最底下的电子线路矩阵所组成
    - 彩色CCD，拜尔滤色镜。两种分色方式（RGB原色分色法，CMYG补色分色法）
    
      排列有50%是绿色，25%是红色，另外25%是蓝色，因此也称做RGBG
    
    - CCD像素合成：像素合成是CCD图像传感器的一种功能，它允许相邻像素的电荷在传感器内部合并，这样可以**低光照条件下提高感光度和信噪比， 但会降低图像的分辨率**
    
    - CCD（电荷耦合器件）图像传感器的核心结构由三层组成，每层功能明确：
    
      CCD 的三层结构：上：增光镜片、中：色块网格、下：感应线路
      
      | **层级**            | **作用**                                                     | **物理特性**                    |
      | ------------------- | :----------------------------------------------------------- | :------------------------------ |
      | **1. 微透镜层**     | 聚焦入射光线，减少反射损失，提高光子捕获效率（提升感光度≥30%） | 二氧化硅/聚合物材质，曲面微结构 |
      | **2. 滤色层**       | 通过Bayer滤色阵列分离RGB光谱，为每个像素分配单一颜色信息     | 有机染料或无机薄膜，厚度0.5-1μm |
      | **3. 光电二极管层** | 将光子转换为电子（光电效应），生成与光强成正比的电荷包       | 硅基PN结，量子效率可达80%       |
    
  - CCD工作原理：
  
    1. 光能→电荷蓄积
  
       每一个CCD组件由上百万个MOS电容所构成，当数字相机的快门开启，来自影像的光线穿过这些马赛克色块会让感光点的二氧化硅材料释放出电子〈负电〉与电洞〈正电〉。经由外部加入电压，这些电子和电洞会被转移到不同极性的另一个硅层暂存起来
  
    2. 电荷转移
  
       - 阶段一，CCD接受光线的照射产生电荷
  
       - 阶段二，外加电压将CCD所『产生』的电荷移往缓冲区
  
       - 阶段三，电荷转换成电压，电压经ADC判读数字讯号
  
       - 阶段四，依顺序将信号移往缓冲区组合
  
         逐行扫描
  
    3. 放大、数字化
  
  - CCD感光能力：感光度是胶片对光线的化学反应程度
  
    ![image-20250612004723838](assets/数字图像处理——光学成像传感器与相机.assets/image-20250612004723838.png)
  
    CCD摄像机最大的ISO值主要是取决于最低的可接受的信噪比（S/N）
  
    感光能力提高：
  
    - 硬件：简化来自特定区域 CCD上的画素信号来提高 ISO 表现（因为CCD无法在物理上增大感光面积，只好联合矩阵在处理上『仿真』大感光面积的方式，所以ISO越高就必须相对的降低分辨率 - 见下图），但这也相对的降低了影像的色调范围
    - 软件：根据数据运算，取得合理的曝光表现，但通常也会伴随着噪声的产生
  
  - CCD像素指标：
  
    - 填充因子（ Fill Factor ）——CCD实际感光面积占像素面积的比值
  
      实际值减30%（隔行传输式CCD），影响灵敏度
  
    - 井深（Well Capacity）——像素可堆积电荷的多少
  
      影响灵敏度的一个因数，衡量动力学范围的一个因素
  
  - CCD控温方式
  
    Cool CCD-消除热或暗电流产生的噪音
  
  - CCD 动力学范围：描述从CCD像素值中可以得到多少数量的灰度级别的一个术语，用来表示饱和电压（最大输出级别）与摄像头随机噪音的比率
  
- CMOS（ Complementary Metal Oxide Semiconductor， 互补金属氧化物半导体）  
  
  ![image-20250620070619036](./assets/%E6%95%B0%E5%AD%97%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E2%80%94%E2%80%94%E5%85%89%E5%AD%A6%E6%88%90%E5%83%8F%E4%BC%A0%E6%84%9F%E5%99%A8%E4%B8%8E%E7%9B%B8%E6%9C%BA.assets/image-20250620070619036.png)
  
  - 核心元件：感光二极管
  - 缺点：开口率低（开口率：有效感光区与整个感光元件面积比值）；灵敏度低、 噪声明显；数模转换无法保证严格一致

下面我们对两种传感器进行比较：

|              | CCD                      | CMOS                                             |
| ------------ | ------------------------ | ------------------------------------------------ |
| 灵敏度       | 同样面积下高，感光性能好 | 感光开口小，灵敏度低                             |
| 速度         | 较慢                     | 快                                               |
| 分辨率       | 像素尺寸下，分辨率高     | 像素尺寸大，分辨率较低                           |
| 信噪比       | 高（噪声小）             | 低（噪声大）                                     |
| 功耗         | 需外加电压，功耗高       | 直接放大，功耗低                                 |
| 成像质量     | 降噪性能好，成像质量高   | 噪声干扰加大，成像质量较差                       |
| 成本         | 成本高                   | 成本低                                           |
| 设计         | 单一感光器，整体放大     | 每个感光单元有放大器                             |
| 拍摄运动图像 | 清晰（均为全局曝光）     | 大多有拖尾现象（大多数按行曝光，极少数全局曝光） |
| 暗电流       | 小                       | 稍大                                             |
| 生产工艺     | 复杂，良率低             | 相对简容，良率高                                 |
| 尺寸结构     | 尺寸大结构复杂           | 尺寸小结构较简单                                 |
| 集成度       | 低，需要增加较多外围电路 | 高，外围电路高度集成                             |
| 应用         | 主要应用于高端专业相机   | 消费类摄像产品，应用广泛                         |

两者主要差异是数字数据传送的方式不同：CCD依次传，CMOS每个像素都会邻接一个放大器及A/D转换电路，用类似内存电路的方式将数据输出

- CCD传感器在灵敏度、分辨率、噪声控制等方面都优于CMOS传感器

- CMOS传感器则具有低成本、低功耗、高整合度的特点

  高驱动电压使 CCD 的电量远高于CMOS

## 图像取样和量化*

对坐标值进行数字化称为取样（或采样） ，对幅度值进行数字化称为量化

- 灰度

- 空间分辨率是图像中最小可辨别细节的测度。单位距离的线对数和单位距离的点数（像素数）是最常用的测度

- 灰度分辨率通常是指量化灰度时所用的比特数

  > 图像系的动态范围定义为系统中最大可度量灰度与最小可检测灰度之比。通常， 图像的动态范围上限取决于饱和度， 下限决于噪声

- 图像内插：内插是用已知数据来估计未知位置的值的过程。 内插可以用来调整图像的大小，缩小和放大基本上采用图像重取样方法

  - 最近邻内插
  - 双线性内插
  - 双三次内插


量化与取样

![image-20250609233230647](assets/数字图像处理Lec1_7.assets/image-20250609233230647.png)

- 图(a)是一副连续图像；
- 图(b)是该图像从A到B的一条扫描线；
- 图(c)对扫描线取样和量化；
- 图(d)是数字化的扫描线

一些运算

- 图像相加（平均）：降低噪声
- 图像惩罚啊和出发：模板区域。校正阴影



## 彩色模型*

对彩色图像的处理是基于对其适当的描述方法，全彩色处理和伪彩色处理

- RGB彩色模型：电视机

- CMY和CMYK彩模型

  CMY颜色模型是基于青色（Cyan）、品红色（Magenta）和黄色（Yellow）三种颜色的**减色系统**（通过从白光中滤去某种颜色来实现颜色混合）。它主要用于印刷和其他需要在纸上沉积彩色颜料的设备。它们的二次色是红、 绿、 蓝

  CMY颜色模型可以通过以下公式从RGB颜色模型转换得到：

  ```
  C = 1 - R青色吸收红色，反射绿+蓝
  M = 1 - G品红吸收绿色，反射红+蓝
  Y = 1 - B黄色吸收蓝色，反射红+绿
  ```

  其中，R、G、B分别表示红、绿、蓝的分量

  <img src="assets/数字图像处理Lec1_7.assets/image-20250306131723928.png" alt="image-20250306131723928" style="zoom:50%;" />

  在印刷行业，以色料减色法为基础的基本模型为CMY，但是目前生产不出理想品质的油墨，所以实用的模型是CMYK， 其中**K是黑色**

- HSI(hue-saturation-intensity)  /HSV(hue-saturation-value)  彩色模型：图像处理算法

  > **色调与饱和度**一起称彩色

  - 色调(Hue)：表明颜色的种类，取决于主波长，由角度表示。 反映了该颜色最接近什么样的光谱波长。 

    > 0°为红色， 120°为绿色，240°为蓝色

  - 饱和度（Saturation)：表示颜色浓淡的物理量。用混入白光量比例（或灰成分混入量）来度量，饱和度参数是色环的原点到彩色点的半径长度

    > 在环的外围圆周是纯的或称饱和的颜色， 其饱和度值为1。 在中心是中性（灰） 色， 即饱和度为0

  - 亮度（lntensity)：人眼所感受到的颜色明暗程度的物理量，用0%到100%表示

    表示光照强度或称为亮度， 它确定了像素的整体亮度， 而不管其颜色是什么

- YUV：视频压缩传输（电视广播）， 屏幕最终仍需转换为RGB发光



## 假彩色图像处理

- 伪彩色

  - 人类更能辨别颜色的深浅和浓淡，为灰度值指定颜色

  - 密度分割

    若将灰度图像级用M个切割平面去切割，会得到 M+1个不同灰度级的区域S1，S2，…，Sm，SM+1。对这M+1个区域中的像素人为分配给M+1种不同颜色，就可以得到具有M+1种颜色的伪彩色图像

  - 灰度级彩色变换

    伪彩色处理技术（在遥感技术中常称为假彩色合成方法） ，可以将灰度图像变为具有多种颜色渐变的连续彩色图像  

  - 滤波法

    这是一种在频率域进行伪彩色处理的技术， 与上面不同的是输出图像的伪彩色与图像的灰度级无关， 而是取决于图像中不同空间频率域成分
    
    例如, 为了突出图像中高频成分（图像细节）将其变为红色，只要将红色通道滤波器设计成高通特性即可。而且可以结合其他处理方法，在附加处理中实施（如直方图修正等），使其彩色对比度更强。如果要抑制图像中某种频率成分，可以设计一个带阻滤波器。从3个不同频率的滤波器输出的信号再经过傅立叶反变换，可以对其做进一步的处理，如直方图均衡化。最后把它们作为三基色分别加到彩色显像管的红、绿、蓝显示通道，从而实现频率域的伪彩色处理



# 期末

- [数字图像处理与机器视觉 2023-2024春夏 回忆卷](https://www.cc98.org/topic/5922736)——感觉不用学
- [2022-2023学年春夏学期 控制学院《数字图像处理与机器视觉》期末考试 回忆卷](https://www.cc98.org/topic/5644557)

# References

- [数字图像处理笔记](https://zhuanlan.zhihu.com/p/556661415)