# Main Takeaway

现代控制理论——advanced控制理论

![b03e1d4cc72397e21d335db370a1888](markdown-img/现控.assets/b03e1d4cc72397e21d335db370a1888.jpg)

每周一交作业，期末a4纸——打印手写均可

**控制理论研究的问题**： **稳定性、准确度、动态性能指标**



# 线性连续系统的分析与校正



## 各种模型转换

[状态空间模型与传递函数的转换关系+例题_状态空间模型转化为传递函数](https://blog.csdn.net/sheagu/article/details/114310271)

- 传递函数域状态空间模型的转换

- 系统框图到状态空间方程

  由系统框图得到微分方程

- 由电路图到传递函数

  [典型环节的传递函数及其电路图-20151103_传递函数的基本环节的电路](https://blog.csdn.net/zhaozhichenghpu/article/details/49706147)



# 线性离散系统的分析与校正  



## 信号采样与保持

[一文书尽离散化——连续系统离散化原理及应用 ](https://zhuanlan.zhihu.com/p/438475328)
$$
u^*(t) = \sum u(t)\delta(t-kT)
$$

### 保持器

保持器是一种将数字信号转换为连续信号的装置，用以解决各采样点之间的插值问题。
$$
u(nT + \Delta t) = {a_0} + {a_1}\Delta t + {a_2}{(\Delta t)^2} + ... + {a_m}{(\Delta t)^m}
$$

- 零阶保持器（m=0,Zero-Order Hold,ZOH）
  $$
  {g_h}(t) = 1(t) - 1(t - T) \\
  
  对 {g_h}(t) 取拉氏变换得到\\
  
  {G_h}(s) = \frac{1}{s} - \frac{{{e^{ - sT}}}}{s} = \frac{{1 - {e^{ - sT}}}}{s}
  $$

  - 低通、相角滞后、时间滞后

  - **零阶保持器特性**：[零阶保持器（ZOH)](https://zhuanlan.zhihu.com/p/44431742)
  
    $V(s)=\frac{{1 - {e^{ - sT}}}}{s}\cdot G(s)\\ V(z)=Z\{V(s)\}=(1-z^{-1})Z\{\frac{G(s)}{s}\}$
  
  > 重要，注意其它Z变换的乘法不能拿出来分开乘
  
- 一阶保持器（m=1）
  $$
  \begin{array}{ccccccccccccccc} {u(nT + \Delta t) = u(nT) + \frac{{u(nT) - u((n - 1)T)}}{T}\Delta t}&{0 \le } \end{array}\Delta t < T
  $$
  
  $$
  \begin{array}{c} {G_h}(s) = \frac{1}{s} + \frac{1}{{T{s^2}}} - \frac{2}{s}{e^{ - Ts}} - \frac{2}{{T{s^2}}}{e^{ - Ts}} + \frac{1}{s}{et^{ - 2Ts}} + \frac{1}{{T{s^2}}}{e^{ - 2Ts}}\\ = T(1 + Ts){\left( {\frac{{1 - {e^{ - Ts}}}}{{Ts}}} \right)^2} \end{array}
  $$

--- ---

### 连续系统离散化

![image-20240910194814097](markdown-img/现控.assets/image-20240910194814097.png)


## Z变换

### 定义

[常用z变换及其收敛域_常用的z变换](https://blog.csdn.net/qq_39573785/article/details/103809560)

[傅里叶变换、拉普拉斯变换、Z 变换的联系是什么？为什么要进行这些变换？](https://zhuanlan.zhihu.com/p/342952028)

Z变换本质上是拉普拉斯变换的离散形式。也称为Fisher-Z变换。对于连续信号进行抽样变换就得到了原函数的离散序列
$$
f_s(t) = f(t)\cdot \delta_T(t)=\sum_{n=0 }^{{\infty }}f(nT)\delta(t-nT) \\
$$
![image-20240911083521196](markdown-img/现控.assets/image-20240911083521196.png)
$$
z= {e^{Ts}}
$$
![image-20240911083822086](markdown-img/现控.assets/image-20240911083822086.png)

定义：

![image-20240911083901199](markdown-img/现控.assets/image-20240911083901199.png)

> 带*即采样

![img](https://pic3.zhimg.com/80/v2-f8498fe712a2630e5da40e259e8dbae8_720w.webp)



### 求解

- [长除法](https://zhuanlan.zhihu.com/p/194103970)

- 级数求和：

  ![image-20240911084019725](markdown-img/现控.assets/image-20240911084019725.png)

- [部分分式法](https://blog.csdn.net/qq_44431690/article/details/107115268)

  ![image-20240911084046222](markdown-img/现控.assets/image-20240911084046222.png)

- [留数法](https://www.bilibili.com/read/cv18912652/?jump_opus=1)

  ![image-20240911084140101](markdown-img/现控.assets/image-20240911084140101.png)

  ![image-20240911084248826](markdown-img/现控.assets/image-20240911084248826.png)

> Notes：只有采样函数能定义Z变换
>
> $F(z)=\sum f(kT)z^{-k}$中，$f(kT)$决定幅值，$z^{-k}$决定时间



### 性质

> 单边Z变换性质

- 线性性质：

  ![image-20240911090207460](markdown-img/现控.assets/image-20240911090207460.png)

- 移位定理

  ![image-20240911090224229](markdown-img/现控.assets/image-20240911090224229.png)

  ![image-20240911091144395](markdown-img/现控.assets/image-20240911091144395.png)

- 初值与终值定理

  ![image-20240911091918356](markdown-img/现控.assets/image-20240911091918356.png)

  > Tips：必须先判断极点在单位圆内

  ![image-20240911092228748](markdown-img/现控.assets/image-20240911092228748.png)

- 复位移定理

  ![image-20240911092258200](markdown-img/现控.assets/image-20240911092258200.png)

- 复域微分定理

  ![image-20240911092844073](markdown-img/现控.assets/image-20240911092844073.png)

  ![image-20240911092903513](markdown-img/现控.assets/image-20240911092903513.png)

- 离散卷积定理

  ![image-20240911093151745](markdown-img/现控.assets/image-20240911093151745.png)



### Z反变换

> 273页查表

mT，m不是整数怎么办？

- 长除法

  ![image-20240911093551205](markdown-img/现控.assets/image-20240911093551205.png)

- 部分分式法

  ![image-20240911125248433](markdown-img/现控.assets/image-20240911125248433.png)

- 留数法

  ![image-20240911125318314](markdown-img/现控.assets/image-20240911125318314.png)

  ![image-20240911125338705](markdown-img/现控.assets/image-20240911125338705.png)

  

### Z变换局限性

输出Z变换函数Y(z)， 只确定了时间函数y(t)在采样瞬时上的数值， 不能反映y(t)在采样间隔中的信息。 故Y(z)的Z反变换y(nT)只能代表采样瞬时t=nT时的数值

**超前采样周期非整数倍的信号如何处理？**  ——要考。加入纯滞后环节

![image-20240911130004494](markdown-img/现控.assets/image-20240911130004494.png)

![image-20240911180716274](markdown-img/现控.assets/image-20240911180716274.png)

![image-20240911180737457](markdown-img/现控.assets/image-20240911180737457.png)

![image-20240911180755761](markdown-img/现控.assets/image-20240911180755761.png)



## 离散系统的数学模型

![image-20240914080855335](markdown-img/现控.assets/image-20240914080855335.png)

在传递函数为P(s)系统下，在前面加上零阶保持器（离散采样）应该如何描述

![image-20240914095135934](markdown-img/现控.assets/image-20240914095135934.png)

### 微分方程与差分方程

![精确解法](markdown-img/现控.assets/image-20240914203446961.png)

获得差分方程——精确解法

![近似解法](markdown-img/现控.assets/image-20240914203640257.png)

获得差分方程——近似解法（前向差分近似）

### 线性差分方程

**通常采用线性定常微分方程描述线性连续系统，采用线性定常差分方程描述线性离散系统**

![image-20240914203902471](markdown-img/现控.assets/image-20240914203902471.png)

<center><h4>差分方程求解</h4></center>

#### 递推法

![image-20240914204045289](markdown-img/现控.assets/image-20240914204045289.png)



#### Z变换法

![image-20240914204446416](markdown-img/现控.assets/image-20240914204446416.png)

先Z变换得到$Y(z)$再Z反变换得到$y(kT)$



### 采样拉式变换性质

> *代表采样

<img src="markdown-img/现控.assets/image-20240914083020118.png" alt="image-20240914083020118" style="zoom:67%;" />

<img src="markdown-img/现控.assets/image-20240914083028849.png" alt="image-20240914083028849" style="zoom:50%;" />

### 脉冲传递函数

离散系统输入输出的复域描述：

![image-20240914204754169](markdown-img/现控.assets/image-20240914204754169.png)

假设

![image-20240914081809763](markdown-img/现控.assets/image-20240914081809763.png)

因为输入是离散的经过零阶保持器输出y(t)是连续信号，我们假设经历过虚拟采样，将y(t)输出也变成离散

![image-20240914205226497](markdown-img/现控.assets/image-20240914205226497.png)

**脉冲传递函数**的定义

有了差分方程和脉冲传递函数的定义，我们来看看如何转化

![前向变换](markdown-img/现控.assets/image-20240914205523977.png)

> 注意： z变换求解差分方程时无零初始条件要求！

![后向变换](markdown-img/现控.assets/image-20240914205810494.png)

> 后向差分方程求脉冲传递函数不需要考虑零初始条件

![image-20240914082234919](markdown-img/现控.assets/image-20240914082234919.png)

为了满足因果序列，m<n，此处用长除法得到单位脉冲响应

--- ---

#### 串联环节

分为又采样器分隔和无采样器分隔的情形

![image-20240914210215151](markdown-img/现控.assets/image-20240914210215151.png)

为$G_1(z)与G_2(z)$相乘

![image-20240914083242684](markdown-img/现控.assets/image-20240914083242684.png)

中间无采样器开关进行采样，则$G_1G_2(s)$为一个整体，为$G_1(s)与G_2(s)$相乘

一般情况下$G_2G_1(z)\neq G_2(z)G_1(z)$

**推论：离散系统的独立环节的划分与连续系统不同，由采样开关分隔**

#### 组合

![image-20240914084013602](markdown-img/现控.assets/image-20240914084013602.png)

组合是先乘再Z变换

#### 并联环节

![image-20240914211243601](markdown-img/现控.assets/image-20240914211243601.png)

并联二者相加即可

------

#### 单闭环系统

因为采样开关位置的不同，有不同的反馈系统

<center><h5>纯连续环节</h5></center>

![image-20240914084411157](markdown-img/现控.assets/image-20240914084411157.png)

现实中不存在，因为经过$H(s)$后还是连续信号，无法与离散信号进行处理

![image-20240914084603513](markdown-img/现控.assets/image-20240914084603513.png)

<center><h5>纯离散环节</h5></center>

![image-20240914085029163](markdown-img/现控.assets/image-20240914085029163.png)

<center><h5>纯离散环节系统框图</h5></center>

![image-20240914085231847](markdown-img/现控.assets/image-20240914085231847.png)

> 梅森公式同样适用

![image-20240914085603932](markdown-img/现控.assets/image-20240914085603932.png)

> 注意特征方程$1+GH(z)$

![image-20240914211943092](markdown-img/现控.assets/image-20240914211943092.png)

> 直接使用Z变换求解，如何写传递函数就看哪里有采样开关进行划分，没有就写$G_1G_2(z)$，有就写$G_1(z)G_2(z)$

![image-20240914090328579](markdown-img/现控.assets/image-20240914090328579.png)

![image-20240914090349648](markdown-img/现控.assets/image-20240914090349648.png)

对上述典型采样闭环反馈系统梅森公式是否适用？

> 系统3不满足，原因见视察法

**视察法：**

![image-20240914090513433](markdown-img/现控.assets/image-20240914090513433.png)

> 主要注意前向通道有无采样开关

#### 复合系统脉冲传函求解

信号变换法+视察法（类似梅森公式，注意2个前提即可）

**example:**

![image-20240914091138032](markdown-img/现控.assets/image-20240914091138032.png)

![视察法](markdown-img/现控.assets/image-20240914091210802.png)

例2：

![image-20240914213119428](markdown-img/现控.assets/image-20240914213119428.png)

![image-20240914213158696](markdown-img/现控.assets/image-20240914213158696.png)

![image-20240914213212455](markdown-img/现控.assets/image-20240914213212455.png)

分别假设另一个为0

直接算其实也很简单，但是要注意其中的各种环节，若是$G(z)$要和$G(s)$分开

#### 总结

![image-20240914213602737](markdown-img/现控.assets/image-20240914213602737.png)

![image-20240914092812351](markdown-img/现控.assets/image-20240914092812351.png)



## 离散系统的状态空间模型

[状态转移矩阵计算方法及其离散化转换（含举例](https://blog.csdn.net/weixin_58399148/article/details/131054919)

[[现代控制\] 二、状态转移矩阵](https://zhuanlan.zhihu.com/p/556915351)

状态转移矩阵$\Phi(t)$描述了
$$
x(t)=\Phi(t)x(0),t\geq 0
$$


### 连续状态方程

两种方法求解连续线性状态方程的全解：

- 直接求解方程（时域）  

  ![image-20240918081330184](markdown-img/现控.assets/image-20240918081330184.png)

  ![image-20240918081401008](markdown-img/现控.assets/image-20240918081401008.png)
  $$
  \Phi(t)= e^{At}
  $$

- 拉式变换

  ![image-20240918082518535](markdown-img/现控.assets/image-20240918082518535.png)

![image-20240918082530738](markdown-img/现控.assets/image-20240918082530738.png)

### 离散状态方程

将连续状态空间模型的离散化  

![image-20240918083505537](markdown-img/现控.assets/image-20240918083505537.png)

于是我们得到离散化状态空间模型，要根据采样时间T来计算

![image-20240918083531600](markdown-img/现控.assets/image-20240918083531600.png)

离散化example

![image-20240918084032715](markdown-img/现控.assets/image-20240918084032715.png)

> 二阶矩阵求逆：主对角线元素互换位置，副对角线元素变为相反数（加负号）；再除以原二阶矩阵对应行列式的值，即可得到其逆矩阵

离散状态方程**求解**：

- 递推法：简单且适合计算机，但无解析式  

  ![image-20240918084436325](markdown-img/现控.assets/image-20240918084436325.png)

- Z变换法：得到解析的闭合形式，代入k值即可计算不同时刻的状态  

  ![image-20240918084537646](markdown-img/现控.assets/image-20240918084537646.png)
  
  ![image-20240923155906720](markdown-img/现控.assets/image-20240923155906720.png)



### 闭环离散系统的状态方程实现

<img src="markdown-img/现控.assets/image-20240918134242949.png" alt="image-20240918134242949" style="zoom:67%;" />

![image-20240918134621844](markdown-img/现控.assets/image-20240918134621844.png)





## 各种模型间的转换

![image-20240918084937240](markdown-img/现控.assets/image-20240918084937240.png)



### 差分到脉冲传函

![image-20240918085001647](markdown-img/现控.assets/image-20240918085001647.png)

### 脉冲传函到差分

分为前向差分($z^{-1 }$)和后向差分

![image-20240918085615480](markdown-img/现控.assets/image-20240918085615480.png)



### 离散状态方程到脉冲传函

> 转换后结果唯一

![image-20240918090032013](markdown-img/现控.assets/image-20240918090032013.png)
$$
G(z)=C(zI-A)^{-1}B+D
$$

### 脉冲传函到离散状态方程

> 转换后结果不唯一
>
> 与连续系统类似，由脉冲传递函数求离散状态方程的问题称为**实现问题**，因状态变量选择的不同，状态方程也就不同
>
> 常见的实现如能控标准型、 能观标准型、 正则标准型(或称并联分解）、 串联分解等。
>
> 与连续系统不同的是，连续系统中采用**积分器**作为基本单元，而在离散系统中则采用**延时器**作为基本单元
>
> ![image-20240918090514679](markdown-img/现控.assets/image-20240918090514679.png)

- 能控标准型

  ![image-20240918090832528](markdown-img/现控.assets/image-20240918090832528.png)

- 能观标准型

  ![image-20240918091201611](markdown-img/现控.assets/image-20240918091201611.png)

  ![image-20240918091730781](markdown-img/现控.assets/image-20240918091730781.png)

  ![image-20240918091344587](markdown-img/现控.assets/image-20240918091344587.png)
  $$
  D(z)=\frac{z^{-1}+7z^{-2}}{1-(-4z^{-1}-3z^{-2})}，然后利用梅森公式画信号流图
  $$

- 正则标准型（并联分解）

  ![image-20240918092202923](markdown-img/现控.assets/image-20240918092202923.png)

  ![image-20240918092514489](markdown-img/现控.assets/image-20240918092514489.png)

- 正则标准型（约当型）

  ![image-20240918092923984](markdown-img/现控.assets/image-20240918092923984.png)

  ![image-20240918093937590](markdown-img/现控.assets/image-20240918093937590.png)

- 串联分解

  ![image-20240918094012968](markdown-img/现控.assets/image-20240918094012968.png)

  记住两个基本单元，讲脉冲传函化为多个基本单元相乘的形式

  ![image-20240918094035958](markdown-img/现控.assets/image-20240918094035958.png)



### 差分到离散状态方程

通常先转化为脉冲传递函数G(z)，然后再转化为状态方程  ——因状态选取不惟一， 状态方程不惟一  



### 离散状态方程到差分

离散状态方程→脉冲传递函数G(z) →差分方程  —— 转换后结果唯一

![image-20240918133144045](markdown-img/现控.assets/image-20240918133144045.png)



能控，能观



## 线代

![image-20240913112751646](markdown-img/现控.assets/image-20240913112751646.png)



## 离散系统的稳定性与稳态误差

s域到z域的映射

![image-20240923080330987](markdown-img/现控.assets/image-20240923080330987.png)

- s平面的虚轴对应z平面的一系列重叠的单位圆
- s平面的左半开平面对应z平面的单位圆的内部
- s平面中虚部 ω为常数的线对应z平面中角度ωT的射线
- s平面中等阻尼比射线映射到z平面是对数螺旋线

### 稳定性条件

![image-20240923080839987](markdown-img/现控.assets/image-20240923080839987.png)

稳定性判别条件

![image-20240923081138445](markdown-img/现控.assets/image-20240923081138445.png)

于是稳定性判断变为对极点位置的判断

- 直接法：直接求**特征方程**的根

  > z域在单位圆内，s域在负半平面内
  >
  > 状态空间方程的特征多项式为$\Delta (s)=|sI-A|$

- 间接法：根据特征多项式系数判断 

  - 劳斯Routh判据（本来用于s域，在z域需经双线性变换变换到w域后使用）

    [双线性变换](https://blog.csdn.net/qq_32515081/article/details/117202181)——双线性变换是自然对数函数的一阶估计法

    ![image-20240923081916057](markdown-img/现控.assets/image-20240923081916057.png)

  - 根轨迹法（不用双线性映射）

> s域的稳定性并不等价于z域的稳定性（二阶采样系统当增益增大时系统不稳定， 二阶连续系统对所有的正增益系统都是稳定的。 这是二者之间的区别。  ）

### 稳定性影响因素

- 开环增益——开环增益越大，稳定性越差
- 零级保持器——加入后给系统引入了一个滞后角，系统稳定性下降
- 采样周期——周期越大，稳定性越低



### 稳态误差

先求误差传递函数

![image-20240923165629502](markdown-img/现控.assets/image-20240923165629502.png)

然后对系统进行稳定性判别，然后利用终值定理

![image-20240923085251228](markdown-img/现控.assets/image-20240923085251228.png)

> 还是需要掌握误差的表达式，因为不一定是下述几种情况

v型系统：含有v个积分环节的系统——先判别系统

![image-20240923085817424](markdown-img/现控.assets/image-20240923085817424.png)

example:

![image-20240923090600769](markdown-img/现控.assets/image-20240923090600769.png)



## 离散系统动态性能分析

动态性能（瞬态性能）

闭环极点与瞬态响应的关系

![image-20240923091542729](markdown-img/现控.assets/image-20240923091542729.png)

单极点

![image-20240923091555114](markdown-img/现控.assets/image-20240923091555114.png)

共轭极点

![image-20240923091621131](markdown-img/现控.assets/image-20240923091621131.png)

![image-20240923091638131](markdown-img/现控.assets/image-20240923091638131.png)

常见动态指标

![image-20240923091707295](markdown-img/现控.assets/image-20240923091707295.png)

常见动态指标

![image-20240923092414085](markdown-img/现控.assets/image-20240923092414085.png)



有限时间响应系统——n拍可结束过渡过程

![image-20240923092400134](markdown-img/现控.assets/image-20240923092400134.png)

瞬态响应计算举例

![image-20240923160923276](markdown-img/现控.assets/image-20240923160923276.png)

![image-20240923160929210](markdown-img/现控.assets/image-20240923160929210.png)

![image-20240923160935075](markdown-img/现控.assets/image-20240923160935075.png)



## 离散系统的数字校正

数字控制系统设计——即设计$D(z)$

### 模拟化设计方法  

![image-20240925081520451](markdown-img/现控.assets/image-20240925081520451.png)

模拟控制器的离散化方法：

![image-20240925084711574](markdown-img/现控.assets/image-20240925084711574.png)

数字PID控制器设计

![image-20240925092348076](markdown-img/现控.assets/image-20240925092348076.png)

以下介绍一下模拟控制器的离散化方法

- 数字PID控制器设计

  目标：将标准的模拟PID公式，进行离散化（后向差分）即得如下增量形式

  ![image-20240925092348076](markdown-img/现控.assets/image-20240925092348076.png)

- 零极点匹配法

  目标：保持与连续控制器一致的**高低通设计性能**， 并保证**主频点附近**相同的**幅频特性**

  设计步骤如下：

  ![image-20240925092932928](markdown-img/现控.assets/image-20240925092932928.png)

  其中步骤3要满足稳态增益一致即$G_c(0)=D(1)$

- 频率特性近似法

  目标：频率特性不变——$D(z)|_{z=e^{jT\omega}}=G_c(s)|_{s=j\omega}$

  方法：使用一些近似方法来满足频率特性

  ![image-20240925093641069](markdown-img/现控.assets/image-20240925093641069.png)

  ![image-20240925093721121](markdown-img/现控.assets/image-20240925093721121.png)

  - Tustin法，重点介绍一下——双线性变换

    > 双线性变换（Tustin transform/bilinear transformation）

    ![image-20240925093824327](markdown-img/现控.assets/image-20240925093824327.png)

    对两种方法的直观理解

    ![image-20240925140719492](markdown-img/现控.assets/image-20240925140719492.png)

    Tustin映射将s左半平面映射到z平面单位圆内，所以也能由稳定的连续控制器产生稳定的离散控制器。但瞬态响应和频率响应均有畸变  

    ![image-20240925141541989](markdown-img/现控.assets/image-20240925141541989.png)

    低频段频率相似，高频段会发生畸变

------

### 数字化设计方法  

数字控制器的设计任务是根据未校正的脉冲传递函数$G(z)=GpH_0(z)$，选择合适的$D(z)$，使开环脉冲传递函数$G(z)D(z)$符合要求。

以下介绍一些常见方法

- z域的根轨迹设计方法

  思想：根据**期望的的闭环极点位置**， 可以用z平面的根轨迹方法进行设计。 一般不在z域采用频率响应方法。 因为包含$z=exp(jwT)$， 无法利用s域中简易的对数作图法

  设计步骤：

  1. 根据给定的时域指标，写出期望的s域闭环极点，然后转换成z域闭环极点

     > 注意回顾一下自控根轨迹方面的知识

  2. 设计数字控制器$D(z)$

  3. 进行数字仿真研究，检验闭环系统的动态响应

  例题：见PPT（）

- w域的设计方法。 在w平面可以采用所有的频域设计方法。注意是伪频

  ![image-20240925150058681](markdown-img/现控.assets/image-20240925150058681.png)

- z域解析设计的方法

  思想：由性能指标和G(z)提出闭环脉冲传递函数$Φ(z)$或闭环误差脉冲传递函数$Φ_e(z)$ 应有的形式， 再推算出D(z)，必须满足物理可实现条件。 

  ![image-20240925150413804](markdown-img/现控.assets/image-20240925150413804.png)

  以下介绍一下常用此方法求解的控制器

  - 最少拍控制器

    设计目标：2个目标

    ![image-20240925150639224](markdown-img/现控.assets/image-20240925150639224.png)

    典型输入：$r(t)=R_it^i$

    ![image-20240925150822113](markdown-img/现控.assets/image-20240925150822113.png)

    无稳态误差最少拍系统的设计分析步骤（根据性能指标要求）：

    ![image-20240925150957784](markdown-img/现控.assets/image-20240925150957784.png)

    > 常常令$F(z)=1$

    ![image-20240925151300454](markdown-img/现控.assets/image-20240925151300454.png)

    无稳态误差最少拍系统设计结果如下表所示

    ![image-20240925151640263](markdown-img/现控.assets/image-20240925151640263.png)

    - 不能保证其它输入下的性能，适应性较差
    - 系统进入稳态后，非采样时刻一般均**存在纹波**
    - ![image-20240925154306334](markdown-img/现控.assets/image-20240925154306334.png)

    针对一些存在的问题，我们给出在物理可实现条件下的改进

    ![image-20240925153241109](markdown-img/现控.assets/image-20240925153241109.png)

    改进后的设计实例见PPT（需要理解一下）

    然后我们来消除纹波，两个消除纹波的必要条件[最少拍控制系统设计（一）-- 最少拍无纹波系统的设计方法_最小拍控制系统设计](https://blog.csdn.net/mengshenglo/article/details/123519381#:~:text=除了满足设计)

    - $G(s)$至少含m-1个积分环节

    - $U(z)/R(z)$为有限多项式

      > 先来思考一下纹波产生的原因$D(z)$的输出的$u(t)$是振荡收敛的，我们希望稳态时可控制信号必须为常数![b93db9127d3f3bb0512237a3865fc387](markdown-img/现控.assets/b93db9127d3f3bb0512237a3865fc387.png)

    最后我们得到无纹波设计方案中$\Phi(z)$的形式为

    ![image-20240925160225995](markdown-img/现控.assets/image-20240925160225995.png)

#### 无纹波最少拍系统设计

[最少拍控制系统设计（一）-- 最少拍无纹波系统的设计方法_最小拍控制系统设计](https://blog.csdn.net/mengshenglo/article/details/123519381#:~:text=1、最少拍无纹波系统的设计方法 按照最少拍有纹波方法所设计出来的系统 ，其输出值在跟随输入的同时在非采样时刻有很大的纹波存在，如图1所示，是以典型的阶跃输入信号为例。,从图中可以看出，其主要原因在于数字控制器的输出在经过一定拍数后是振荡收敛的。 纹波位于采样点时间，使得偏差的存在，机械的磨损是必须要考虑的问题，另外机器执行命令过程中浪费的功率也不容忽略。 为消除采样点间纹波，采样最少拍无纹波系统的设计，使系统输出值不仅在采样点上，而且在采样点之间稳态误差都等于零，仍以阶跃信号输入为例，最少拍无纹波系统的输出曲线如图2所示。)

最终我们总结无纹波最少拍系统设计原则：

![image-20240925160612763](markdown-img/现控.assets/image-20240925160612763.png)

具体例子可见PPT



#### 小结

![image-20240925160908356](markdown-img/现控.assets/image-20240925160908356.png)













# 状态空间State-Space

## 定义

State-Space：集合{输入、输出、状态变量}用一系列一阶微分方程表示

> 选择状态变量消除高阶项，状态变量的**最小**数量=系统中**独立**储能元件数量

一般State variables representation (状态空间表达式)：
$$
\dot x=f(x(t),u(t),t)\\
y=g(x(t),u(t),t)\\
$$
线性定常系统的状态空间模型：

state equation：状态变量与输入变量的关系
$$
\dot x(t)=Ax(t)+Bu(t)
$$
output equation：输出变量与状态变量、输入变量的关系
$$
y(t)=Cx(t)+Du(t)
$$

![6916f98f9ed78ce6afa6faeb924e4a1](markdown-img/现控.assets/6916f98f9ed78ce6afa6faeb924e4a1.jpg)
$$
G(s) = C(sI-A)^{-1}B+D
$$

> 其中
>
> - A系统矩阵——状态矩阵
> - B输入矩阵——控制矩阵
> - C输出矩阵
> - D前馈矩阵
>
> 若D=0则为惯性系统；若$D\ne 0$为非惯性系统，意味着输入变量与输出变量有直接关联

- 传函分子为1

  ![在这里插入图片描述](https://img-blog.csdnimg.cn/20210303140441985.png)

- 传函分子不为1

  ![在这里插入图片描述](https://img-blog.csdnimg.cn/20210303141423946.png)

  ![在这里插入图片描述](https://img-blog.csdnimg.cn/20210303141538853.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NoZWFndQ==,size_16,color_FFFFFF,t_70)

![image-20240909172420842](markdown-img/现控.assets/image-20240909172420842.png)

## 状态空间的解

[定量分析（一）：状态空间表达式的解（定常系统） - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/665307443)
$$
\dot{x_1}(t) = Ax_1(t)\longrightarrow x_1(t) = x_1(0)e^{At},e^{At}=L^{-1}\{(sI-A)^{-1}\}
$$

当其中$x_1(t)$变为n*1的向量时，前面的A也会相应的变为n\*n的矩阵



![image-20240909192637820](markdown-img/现控.assets/image-20240909192637820.png)

矩阵指数函数——用泰勒级数展开

![image-20240909193427516](markdown-img/现控.assets/image-20240909193427516.png)

状态空间的解：
$$
\vec{x}(t)=e^{A(t-t_0)}\vec{x}(t_0)+\int_{t_0}^{t} e^{A(t-\tau)}B\vec{u}(\tau)d\tau
$$

![image-20240915213837376](markdown-img/现控.assets/image-20240915213837376.png)

传递函数求极点和求A矩阵的特征值殊途同归

![image-20240915214349488](markdown-img/现控.assets/image-20240915214349488.png)

## 相图、相轨迹Phase Portrait

某处导数为0，为平衡点(Fixed Point or Equilibrium Point)

![image-20240910193744179](markdown-img/现控.assets/image-20240910193744179.png)

特征值虚部不为0，则会造成振动

2-D：使用状态空间矩阵的特征值即可看出系统性质（与求极点相似）

![image-20240910192338197](markdown-img/现控.assets/image-20240910192338197.png)

如果特征值为复数（仅虚部），则相图为椭圆——方向再判断

![image-20240910192725627](markdown-img/现控.assets/image-20240910192725627.png)



## 动态系统分析

多说无益，自己见视频



## 系统性质





### 能控性Controllability

![image-20240911081004558](markdown-img/现控.assets/image-20240911081004558.png)

![image-20240911081306696](markdown-img/现控.assets/image-20240911081306696.png)

当$C_o=[B\ AB \ A^2B ... \ A^{n-1}B ]$为满秩时系统可控——根据系统阶次判断$rank(C_0)$

> 可控只能说明点到点，不能控制轨迹

![image-20240930083931667](markdown-img/现控.assets/image-20240930083931667.png)

![image-20240930085204748](markdown-img/现控.assets/image-20240930085204748.png)

![image-20240930085755218](markdown-img/现控.assets/image-20240930085755218.png)

![image-20240930085946850](markdown-img/现控.assets/image-20240930085946850.png)

PBH向量判据

![image-20240930090025132](markdown-img/现控.assets/image-20240930090025132.png)

PBH秩判据

![image-20240930090315212](markdown-img/现控.assets/image-20240930090315212.png)

对角线规范型判据：系统矩阵A为对角阵，且对角线上元素互异时，系统状态完全能控的充要条件是输入矩阵B不存在元素全为0的行

对角元素互异约当规范型判据： A为约当阵且不同约当块具有不同对角元素时，系统状态完全能控的充要条件是输入矩阵B的与每个约当块末行对应的行元素不全为0，更多的约当块是分块对角阵，只要各分块内部行线性无关，整个矩阵即行线性无关

> 先判断有几个约当块

![image-20240930091312869](markdown-img/现控.assets/image-20240930091312869.png)

### 输出能控性

![image-20240930091528104](markdown-img/现控.assets/image-20240930091528104.png)
$$
rankQ=[CB~CAB~...~CA^{n-1}B~D]
$$



### 稳定性Stability

[现代控制理论（4）——李雅普诺夫稳定性理论_李亚普诺夫稳定性](https://blog.csdn.net/wang7301/article/details/121318908)

![image-20240911165454510](markdown-img/现控.assets/image-20240911165454510.png)

LTI——用特征值特征向量来分析

对于非线性系统就用李雅普诺夫方程来分析



### 能观性Observability

#### 能观性定义

定义：如果一个系统可观测：$D=\left[ \begin{matrix}  C  \\  CA \\ ...\\ CA^{n-1} \end{matrix} \right] ,rank(D)=n$

![image-20241009080924924](markdown-img/现控.assets/image-20241009080924924.png)

#### PBH判据

![image-20241009081040622](markdown-img/现控.assets/image-20241009081040622.png)

{C, A｝能观的充分必要条件是对所有的特征值$\lambda_i$满足：
$$
\left[ \begin{matrix}  C  \\  \lambda_iI-A \end{matrix} \right]=n
$$

#### 对偶原理

（Duality Principle)  

对偶系统如下：

![image-20241009081345098](markdown-img/现控.assets/image-20241009081345098.png)

对偶原理：互为对偶的系统 S1和S2 ，它们的能控性和能观性也成对偶关系，即系统S1的能控性等价于系统S2的能观性，系统S1的能观性等价于系统S2的能控性

> ![image-20241009081447364](markdown-img/现控.assets/image-20241009081447364.png)

#### 特殊系统判断

- 对角规范型：A为对角阵，且对角线上元素互异时，系统状态完全能观的充要条件是输出矩阵C不存在元素全为0的列
- 对角元素互异约当规范型：A为约当阵且不同约当块具有不同对角元素时，系统状态完全能观的充要条件是输出矩阵C的与每个约当块首列对应的列元素不全为0  
- 对角元素相同约当规范型判据：A为约当阵，但不同约当块具有相同对角元素时，系统状态完全能观的充要条件是输出矩阵C的与每个约当块首列对应的那些列彼此线性无关

<img src="markdown-img/现控.assets/image-20241009082234253.png" alt="image-20241009082234253" style="zoom:50%;" />

### 离散系统的能控性能观性

![image-20241009082723501](markdown-img/现控.assets/image-20241009082723501.png)

![image-20241009082732637](markdown-img/现控.assets/image-20241009082732637.png)

![image-20241009082748461](markdown-img/现控.assets/image-20241009082748461.png)

> 如果采样周期 T 选择得不妥当的话， 一个能控的连续系统离散化后不一定能保持其能控性；同样， 一个能观的连续系统离散化后也不一定能保持其能观性  



### 分离原理Separation Principle

观测器+控制器——系统可控+可观，但是x不可测量

![image-20240915145058437](markdown-img/现控.assets/image-20240915145058437.png)

先设计观测器，然后设计控制器

![image-20240915145213665](markdown-img/现控.assets/image-20240915145213665.png)

![image-20240915145311002](markdown-img/现控.assets/image-20240915145311002.png)

分别让实部都<0，这样让控制器和观测器分开——即为分离原理

一般情况下我们要让obverser faster than controller，因为我们希望有准确的观测值来指导控制器的输出。



## 各形式与状态空间方程

[状态空间模型与传递函数的转换关系+例题_状态空间模型转化为传递函数](https://blog.csdn.net/sheagu/article/details/114310271)

- 传递函数到状态空间模型

  ![image-20241016094801470](markdown-img/现控.assets/image-20241016094801470.png)

  ![fab87848052c4eaeda11dfb5b2960dd](markdown-img/现控.assets/fab87848052c4eaeda11dfb5b2960dd.jpg)
  
- 系统框图到状态空间方程

  由系统框图得到微分方程——化简得到状态方程

  ![image-20241014101352428](markdown-img/现控.assets/image-20241014101352428.png)



- 相互转化——见线性连续系统的分析与校正

- 传递函数与能控能观性讨论——[基于零极点的最小实现和能控能观性讨论_零极点对消对能控能观的影响](https://blog.csdn.net/weixin_40999869/article/details/114794581)

  零极点不能相消是系统能控能观性的充分必要条件

  ![image-20241012081731360](markdown-img/现控.assets/image-20241012081731360.png)



## 线性变换和结构分解

### 非奇异线性变换及其不变特性

非奇异线性变换：

![image-20241009083834663](markdown-img/现控.assets/image-20241009083834663.png)

状态的非奇异线性变换在代数上等价于系统的坐标变换！  

> P为坐标变换矩阵  ，Q为状态变换矩阵  

典型变换：

<img src="markdown-img/现控.assets/image-20241009084054335.png" alt="image-20241009084054335" style="zoom:50%;" /> 

状态空间模型的非奇异线性变换  ：

![image-20241009084159360](markdown-img/现控.assets/image-20241009084159360.png)

那么这样变换后有什么好处呢？

非奇异线性变换的不变特性  ：

- 特征方程不变（特征值不变、极点不变）
- 输入输出关系不变（传递函数不变）
- 能控性不变
- 能观性不变



### 状态空间的标准型变换

采用状态空间模型描述一个动态系统时，其形式不是惟一的,可以在不同的状态空间实现。

因此我们经过线性非奇异变换在不改变系统原有的外部与内在特性的情况下，为了有助于系统的分析与控制系统的设计， 往往有意识地选择合适的变换， 使得系统矩阵 A 具有某种特殊的结构形式

#### 对角规范型

对角规范型（约当规范型） ⇒解耦控制

![image-20241009085928853](markdown-img/现控.assets/image-20241009085928853.png)

![image-20241009090002596](markdown-img/现控.assets/image-20241009090002596.png)

- 先求特征值$|\lambda I-A|$，然后根据特征值求得特征向量

- 得到变换矩阵$T=[v_1,v_2,...v_n]$

  ![image-20241012170927472](markdown-img/现控.assets/image-20241012170927472.png)



**友矩阵的变换矩阵**：

<img src="markdown-img/现控.assets/image-20241009090410503.png" alt="image-20241009090410503" style="zoom:50%;" />

**Jordan 规范型变换**

![image-20241009090900242](markdown-img/现控.assets/image-20241009090900242.png)

求广义特征向量，具体见ppt上例子

#### 能控规范型

能控规范型⇒极点配置

![image-20241009091225392](markdown-img/现控.assets/image-20241009091225392.png)

能控标准型与特征多项式关系

![image-20241009091735636](markdown-img/现控.assets/image-20241009091735636.png)

所以这种情况下不用求$T^{-1}$



#### 能观规范型

能观规范型⇒状态观测器设计

![image-20241023161207083](markdown-img/现控.assets/image-20241023161207083.png)

![image-20241012171413053](markdown-img/现控.assets/image-20241012171413053.png)

![image-20241009091247909](markdown-img/现控.assets/image-20241009091247909.png)

![image-20241023161351154](markdown-img/现控.assets/image-20241023161351154.png)





### 状态空间的能控能观结构分解

不变子空间分解

![image-20241012080657578](markdown-img/现控.assets/image-20241012080657578.png)



![image-20241012081129629](markdown-img/现控.assets/image-20241012081129629.png)

- 能控子空间分解

  ![image-20241012081201180](markdown-img/现控.assets/image-20241012081201180.png)

  ![image-20241012081217668](markdown-img/现控.assets/image-20241012081217668.png)

  ![image-20241012081235584](markdown-img/现控.assets/image-20241012081235584.png)

- 能观子空间

  ![image-20241012081257126](markdown-img/现控.assets/image-20241012081257126.png)

  ![image-20241012081311153](markdown-img/现控.assets/image-20241012081311153.png)

  ![image-20241012081320158](markdown-img/现控.assets/image-20241012081320158.png)

- 能控能观子空间分解

  ![image-20241012081401619](markdown-img/现控.assets/image-20241012081401619.png)

  

状态空间模型与传递函数

![image-20241012081750156](markdown-img/现控.assets/image-20241012081750156.png)

> ![image-20241012082152261](markdown-img/现控.assets/image-20241012082152261.png)

最小实现：描述一个SISO动态系统的状态方程不是惟一的，即实现问题。

{A， b， c} 称为SISO系统的最小实现， 当且仅当其转化的传递函数G(s)无零极点对消

> 如果出现相消，三种情况：系统不能控不能观  ；系统能控不能观  ；系统不能控能观
>
> 注意：能控能观是系统状态空间实现的结构性质，不是传递函数的性质  



## 状态反馈

基于状态反馈的典型控制问题

输出反馈极点配置的局限性：根据根轨迹图我们知道$G_c(s)=K_c$无法通过设计$K_c$得到任意期望闭环极点，所以我们使用**状态反馈**

![image-20241012084328047](markdown-img/现控.assets/image-20241012084328047.png)

问题：是否任意的状态空间系统均可进行任意的期望极点配置？——当然要能控啦

定理1： 一个开环系统｛ A， B， C｝ 通过状态反馈控制可以任意配置闭环极点的充分必要条件是该系统｛ A， B｝ 状态**完全能控**

> 不能控子系统的极点不可通过状态反馈改变——所以要先判断是否完全能控

![image-20241023150744375](markdown-img/现控.assets/image-20241023150744375.png)

### 系统性质

状态反馈系统的能控性：状态反馈控制不影响系统的能控性

状态反馈系统的能观性：状态反馈控制可能影响系统的能观性。

> 对于SISO系统状态反馈具有零点不变性  
>
> ![image-20241012085957236](markdown-img/现控.assets/image-20241012085957236.png)

输出反馈系统：不影响系统的能观性，能控性



### 状态反馈设计

这部分主要是做题，把PPT上例题都看一下

- 直接法：不对状态方程作任何变换，直接求解状态反馈的方法

  先判断能控性

  ![image-20241014102549437](markdown-img/现控.assets/image-20241014102549437.png)

- 能控标准型法

  ![](markdown-img/现控.assets/image-20241012092329590.png)

  > 第二步仍是直接法，然后反解$k_p$

  先确定能控性，列写开环特征多项式：$\Delta=det[\lambda I-A_p]$

  然后构造矩阵$T_c$，将一般状态方程转换为能控标准型

  根据采用的状态反馈阵，得到新的反馈系统的特征多项式

  ![image-20241014102939621](markdown-img/现控.assets/image-20241014102939621.png)

  最后使用直接法得到系数

  ![image-20241012093354065](markdown-img/现控.assets/image-20241012093354065.png)

  要记得得到$K_c$后要变换至原状态空间

  ![image-20241012092944509](markdown-img/现控.assets/image-20241012092944509.png)
  



状态反馈设计就是极点配置问题

- 直接法
- 相变量法

### 配置极点

- 物理变量法

  为了得到最多的可测状态，经常选取物理变量为状态变量

  <img src="markdown-img/现控.assets/image-20241014104124845.png" alt="image-20241014104124845" style="zoom:50%;" />

- 反馈补偿器

  ![image-20241014104213156](markdown-img/现控.assets/image-20241014104213156.png)

  > 注意状态反馈如何求$H_{eq}=\frac{B(s)}{Y}$

  状态反馈等价于在传统单位反馈控制系统的反馈回路中插入一个**反馈补偿器**。 故可以用直观的**根轨迹方法**来理解和指导状态反馈设计  

  状态反馈给开环传递函数$G(s)H_{eq}(s)$引入了附加零点， 没有增加极点。通过设置$H_{eq}(s)$的零点可以产生期望的响应  

  模型分析：

  ![image-20241014105432278](markdown-img/现控.assets/image-20241014105432278.png)
  
  

极点配置设计步骤：

![image-20241014105532157](markdown-img/现控.assets/image-20241014105532157.png)

设计举例：全极点系统/零极点系统——见PPT

- 全极点系统：和之前的设计一样

- 零极点系统：因为零极点对消，所以在设计时，应该上下乘回来，之后的特征方程计算和全极点一样——这样可满足稳定性的要求，但是可能对增益的变化非常敏感，解决方法见下（即加入一个非主导极点）

  注意：状态反馈不改变系统的零点



设计过程小结

![image-20241016083034397](markdown-img/现控.assets/image-20241016083034397.png)

怎样做到对增益变化的不敏感性？——因为在根轨迹中，轨迹终止与开环零点，如果我们将主导极点设计在开环零点附近，就可以消除对增益变化的敏感性

> 系统的动态响应几乎不受增益A变化的影响
>
> ![image-20241016093446479](markdown-img/现控.assets/image-20241016093446479.png)
>
> ![image-20241016093559916](markdown-img/现控.assets/image-20241016093559916.png)
>
> 无法同时满足稳定性和灵敏度的要求

因为由动态特性所决定的期望共轭主导极点位置不能变， 所以只能增加一个**非主导极点**——提高分母阶次，在前向通道串联一个环节，**使3个相对主导的闭环极点的位置和零点相近**  





## 状态观测

### 基本思想

实时状态变量由系统输入和输出估计得到

![image-20241016083326691](markdown-img/现控.assets/image-20241016083326691.png)

- 直接解析估计

  工程中不能实现真正的微分，因此不可行

- 直接重构估计

  ![image-20241016083548610](markdown-img/现控.assets/image-20241016083548610.png)

  局限性

  ![image-20241016083601222](markdown-img/现控.assets/image-20241016083601222.png)

上述两种方法都不好用，我们接下来介绍系统状态观测器



### 全维状态观测器

思想：引入输出估计误差反馈

![image-20241016083803075](markdown-img/现控.assets/image-20241016083803075.png)

针对上述观测器，我们来进行**估计误差分析**

![image-20241016083921787](markdown-img/现控.assets/image-20241016083921787.png)

为了使估计误差小，就有了我们的设计目标

![image-20241016084022087](markdown-img/现控.assets/image-20241016084022087.png)

我们要求快速性，是因为需要根据观测器来计算控制器，因此观测器要比控制器更快

### 观测器极点配置

![image-20241016084211215](markdown-img/现控.assets/image-20241016084211215.png)

> 证明见PPT

如何设计：

**直接法**

![image-20241016084655727](markdown-img/现控.assets/image-20241016084655727.png)

设计方法分析

![image-20241016085053425](markdown-img/现控.assets/image-20241016085053425.png)

能观标准型法

维度较高，则先化为能观标准型

![image-20241016085305276](markdown-img/现控.assets/image-20241016085305276.png)

### 分离原理

复合系统出现的问题

![image-20241016090143634](markdown-img/现控.assets/image-20241016090143634.png)

控制器和观测器是否能分别独立进行，一起用会有问题吗？

![image-20241016090229494](markdown-img/现控.assets/image-20241016090229494.png)

根据分离定理：状态反馈阵K和状态观测器H阵的设计可分别独立地进行



### 降维状态观测器

降维状态观测器的思想

![image-20241021080824763](markdown-img/现控.assets/image-20241021080824763.png)

变换矩阵P的设计

![image-20241021080851770](markdown-img/现控.assets/image-20241021080851770.png)

目的就是使得$CP$的前$m$项针对可观测的向量变为单位矩阵——于是变换后前m项还是y，我们只需要使用观测器估计$(n-m)$个状态

![image-20241021081549039](markdown-img/现控.assets/image-20241021081549039.png)

现在要对$\bar{x}_2$进行观测器的设计，于是我们定义虚拟输入和虚拟输出$\bar{u},\bar{w}$

![image-20241021081807915](markdown-img/现控.assets/image-20241021081807915.png)

> 全阶能观是降阶能观的充分条件

在前面进行预处理后，我们得到降维后的系统

![image-20241021082306570](markdown-img/现控.assets/image-20241021082306570.png)

![image-20241021084445604](markdown-img/现控.assets/image-20241021084445604.png)

所以特征方程为$\Delta = |sI-(\bar{A}_{22}-L\bar{A}_{12})|$

因为$\dot{y}$在物理上不可实现是未知量，所以我们将其移到左边去，进行变量置换

![image-20241021082347633](markdown-img/现控.assets/image-20241021082347633.png)

在得到观测器后，我们将其还原到原系统

![image-20241021082448446](markdown-img/现控.assets/image-20241021082448446.png)

对上述过程进行总结，得到**设计步骤**：

![image-20241021082522688](markdown-img/现控.assets/image-20241021082522688.png)

> 注意
>
> step1中还要判断最小维状态观测器的维数$(n-m)=n-rank(C)$
>
> step2中要计算变换后的系统
>
> ![image-20241021083353465](markdown-img/现控.assets/image-20241021083353465.png)
>
> step3根据想要配置的极点进行设计
>
> ![image-20241021083754467](markdown-img/现控.assets/image-20241021083754467.png)
>
> 特征方程为$\Delta = |sI-(\bar{A}_{22}-L\bar{A}_{12})|$
>
> step4反变换
>
> ![image-20241021083808697](markdown-img/现控.assets/image-20241021083808697.png)





# 线性控制器设计



## how to design

![image-20240912170500446](markdown-img/现控.assets/image-20240912170500446.png)

![image-20240912172323068](markdown-img/现控.assets/image-20240912172323068.png)

我们设计一个线性反馈控制器$u=-kx$，——让系统稳定的条件是矩阵$A_{cl}$的特征值的实部均为负数，因此我们可以**手动选择**几个满足上述条件的特征值，然后反解出$k$，从而得到控制器。

> 如何确定我们想要的闭环系统的特征值$\lambda$，见下一章LQR

## example

![image-20240912171654259](markdown-img/现控.assets/image-20240912171654259.png)

先将微分方程转换为状态空间方程

![image-20240912171641751](markdown-img/现控.assets/image-20240912171641751.png)

首先分析开环特性，即求A的特征值，有一个值>0则系统不稳定

![image-20240912171801800](markdown-img/现控.assets/image-20240912171801800.png)

算$C_0$发现其可控

![image-20240912171852802](markdown-img/现控.assets/image-20240912171852802.png)

最后求其闭环系统特性

![image-20240912171922574](markdown-img/现控.assets/image-20240912171922574.png)

得到闭环系统的系统矩阵解出k1,k2

## 轨迹跟踪(Follow a Desired Path)

为了实现轨迹跟踪，即我们想要收敛的平衡点改变，就需要调整输入u来改变平衡点——如何调整u，见下：



![image-20240913120151050](markdown-img/现控.assets/image-20240913120151050.png)

先计算开环算出平衡点

为了实现轨迹跟踪，我们加入变量$x_{1d}$作为期望点 ![image-20240913120449961](markdown-img/现控.assets/image-20240913120449961.png)

设定误差e，转换公式，得到新的状态方程

![image-20240913120734438](markdown-img/现控.assets/image-20240913120734438.png)

这里我们计算开环平衡点发现$e\neq0$，所以我们要用u调整e=0，即代入u后可以把后面那个常数消掉

![image-20240913121001498](markdown-img/现控.assets/image-20240913121001498.png)

设置u，消除常数，得到新的状态空间方程

![image-20240913121058470](markdown-img/现控.assets/image-20240913121058470.png)

针对新的方程，要满足收敛即特征值<0，设置特征值为-1（随便设的），计算出控制器u

## LQR控制器

[线性二次型调节器(LQR)原理详解](https://blog.csdn.net/qq_36133747/article/details/123413115)



### 思想

- LQR——linear Quadratic（二次） Regulator（调节器）：利用代价函数来选择特征值

  > Regular意味着这种反馈的功能是将系统状态调节为0，这在一些追踪问题中会受到约束，因为我们可能希望稳定状态是给定的非零值。

引入Cost Func

![image-20240912173916568](markdown-img/现控.assets/image-20240912173916568.png)
$$
\min J = \int_0^{x}(x^TQx+u^TRu)dt
$$

![image-20240915152325643](markdown-img/现控.assets/image-20240915152325643.png)

调参：想让状态量收敛更快还是输入量收敛更快（常节省能量）

### 如何求解

现在的问题是，我们该如何求解$K$才能让代价函数$J$最小呢？
推导过程见[线性二次型调节器(LQR)原理详解](https://blog.csdn.net/qq_36133747/article/details/123413115)，结论如下：

反馈矩阵K满足
$$
K=R^{-1}B^TP
$$
辅助矩阵P满足代数Riccati方程(ARE)
$$
A^T P+PA-PBR^{-1}B^TP+Q=0
$$
综上，求解LQR参数K的过程为：

- 设计参数矩阵Q，R——调参
- 求解ARE方程得到辅助矩阵P
- 令$K=R^{-1}B^TP$

> 目前已有求解ARE很完善的数值程序，例如MATLAB把它封装进了`lqr(A,B,Q,R)`函数中。



[最优控制：代数黎卡提方程ARE(Algebraic Riccati Equation)_riccati方程 最优控制](https://blog.csdn.net/weixin_44346182/article/details/131420982)

![4fbe61989e27594e479c678338fd7ec4](markdown-img/现控.assets/4fbe61989e27594e479c678338fd7ec4.png)

```
% 系统矩阵
A = [-1 0; 0 -2]
% 控制输入矩阵
B = [1; 1];
% 状态权重矩阵
Q = eye(2);
% 控制输入权重矩阵
R = 1;
 
% 求解代数黎卡提方程
[P,~,~] = care(A, B, Q, R);
 
% LQR控制器设计
K = inv(R) * B' * P;
% 打印结果
disp('最优控制器增益矩阵 K:');
disp(K);
```

### 可控性

只要满足一些**基本条件**，LQR的设计过程就能保证得到一个让系统稳定的反馈控制器

![image-20240915154611846](markdown-img/现控.assets/image-20240915154611846.png)

用LQR设计反馈控制器和经典控制的思想有很大不同，例如：

- 设计参数矩阵$Q，R$与希望的闭环性能密切相关

- 引入了辅助矩阵P
- 求解矩阵设计方程
- 能得到一个保证系统稳定的解
- 对闭环系统的鲁棒性或结构了解有限

使用现代控制和经典控制结合方法来获得额外的鲁棒性insight很重要，例如基于奇异值伯德图的LQG/LTR方法。





# 状态观测器设计Linear Observer Design

![image-20240913102358606](markdown-img/现控.assets/image-20240913102358606.png)

![image-20240915144358128](markdown-img/现控.assets/image-20240915144358128.png)

观测器设计动机：当x不可测的时候，设$\hat x$为估计值——设计观测器来让误差$e\rightarrow 0$

观测器observer：根据系统的输入和输出来估计系统的状态

## Luenberger Observer

![image-20240913102849146](markdown-img/现控.assets/image-20240913102849146.png)

注意此处观测器的形式!
$$
\dot{\hat{x}} = (A-LC)\hat{x}+(B-LD)u+Ly
$$
![image-20240913103236095](markdown-img/现控.assets/image-20240913103236095.png)

> 最后和设计控制器方法一样

## example

![image-20240913104027965](markdown-img/现控.assets/image-20240913104027965.png)

对系统建模得到状态空间方程

![image-20240913104123877](markdown-img/现控.assets/image-20240913104123877.png)

![image-20240913104634491](markdown-img/现控.assets/image-20240913104634491.png)





# 非线性系统

[非线性与自适应控制（一）非线性系统描述](https://zhuanlan.zhihu.com/p/343680379)

考虑一个非线性动力系统通常可用如下的非线性一阶微分方程描述
$$
\dot x = f(t,x,u),x_0=x(0)
$$

## 非线性系统

- 存在多个孤立的平衡点——要会求

  ![image-20241023080807353](markdown-img/现控.assets/image-20241023080807353.png)

  > 有限时间逃逸

- 稳定性分析

  ![image-20241023080927958](markdown-img/现控.assets/image-20241023080927958.png)

- 自激振荡——一般希望避免

  > 二阶系统的自激振荡称为极限环  

  ![image-20241023081050708](markdown-img/现控.assets/image-20241023081050708.png)

- 倍频、分频振荡与畸变

  ![image-20241023081730823](markdown-img/现控.assets/image-20241023081730823.png)

- 跳跃谐振与多值响应

  ![image-20241023081908807](markdown-img/现控.assets/image-20241023081908807.png)

![image-20241023082013461](markdown-img/现控.assets/image-20241023082013461.png)

强非线性系统无法利用线性化近似

下面介绍一些典型的非线性系统的特性

![image-20241023082316382](markdown-img/现控.assets/image-20241023082316382.png)

## 研究非线性的方法

![image-20241023083132198](markdown-img/现控.assets/image-20241023083132198.png)

### 描述函数法

描述函数： 非线性环节稳态正弦响应中的基波分量与输入正弦量的比  

> 实质将非线性环节近似当作线性环节处理， 因此可采用频域分析；

![image-20241023084539794](markdown-img/现控.assets/image-20241023084539794.png)

其中G为线性部分的传递函数，因为希望保留NL的基波和低次谐波特性，因此G需要具有较好的低通滤波特性

描述函数的概念

![image-20241023084843081](markdown-img/现控.assets/image-20241023084843081.png)

描述函数定义为$N(A)=\frac{B}{A}e^{j\phi}$

算傅里叶技术即可

#### 描述函数的特点

1） 这类非线性环节可等效为一个**变增益线性放大器**； 

2） 放大倍数仅是A和非线性特性参数的函数  

频域近似分析

![image-20241023090125875](markdown-img/现控.assets/image-20241023090125875.png)

变增益系统的Nyquist判据

![image-20241023090542783](markdown-img/现控.assets/image-20241023090542783.png)

> 下面的$G(j\omega)$就是上面的$G(s)$把s换掉

描述函数下的Nyquist判据

![image-20241023090849048](markdown-img/现控.assets/image-20241023090849048.png)

**自激振荡**

![image-20241023090924802](markdown-img/现控.assets/image-20241023090924802.png)

自激振荡稳定性分析

![image-20241023091011789](markdown-img/现控.assets/image-20241023091011789.png)

> 稳定区域使A减小；不稳定区域使A增大，然后看箭头方向是否进行振荡

看看PPT上的例题

### Lyapunov 稳定性分析

![image-20241029001426543](markdown-img/现控.assets/image-20241029001426543.png)

自治系统的解与初始时刻、初始状态有关

![image-20241029001653966](markdown-img/现控.assets/image-20241029001653966.png)

#### 稳定

- Lyapunov稳定

  ![image-20241029001910236](markdown-img/现控.assets/image-20241029001910236.png)

- 渐进稳定

  ![image-20241029001934170](markdown-img/现控.assets/image-20241029001934170.png)

- ![image-20241029002032853](markdown-img/现控.assets/image-20241029002032853.png)

- Lyapunov不稳定

  ![image-20241029002053064](markdown-img/现控.assets/image-20241029002053064.png)

![image-20241029002142427](markdown-img/现控.assets/image-20241029002142427.png)

#### Lyapunov第一法（间接法）  

第一法（间接法）基本思路： 在平衡点处线性化，用线性系统的稳定性理论分析

平衡点处泰勒展开并忽略高阶项得到Jacobian矩阵

![image-20241029002328837](markdown-img/现控.assets/image-20241029002328837.png)

线性定常系统稳定性判别：

![image-20241029002512799](markdown-img/现控.assets/image-20241029002512799.png)

第一方法的稳定性判别

![image-20241029002530260](markdown-img/现控.assets/image-20241029002530260.png)

Lyapunov第一法所得的稳定性判定结果为局部稳定性判定  

#### Lyapunov第二法（直接法）

基本思想是用能量的观点分析系统的稳定性

> 如果系统有一个渐近稳定的平衡状态， 则当其运动到平衡状态的吸引域内时， 系统存储的能量随着时间的增长而衰减， 直到在平稳状态达到极小值为止。 反之， 若是不断地从外界吸取能量， 储能越来越多， 则平衡状态是不稳定的
>
> 仅讨论**原点稳定性**问题  

![image-20241029002645093](markdown-img/现控.assets/image-20241029002645093.png)

二次型

![image-20241029002815393](markdown-img/现控.assets/image-20241029002815393.png)

渐进稳定判别基本定理  

![image-20241029002842112](markdown-img/现控.assets/image-20241029002842112.png)

渐进稳定判别定理II  

![image-20241029003037636](markdown-img/现控.assets/image-20241029003037636.png)

Lyapunov稳定判别定理  

![image-20241029003127069](markdown-img/现控.assets/image-20241029003127069.png)

Lyapunov不稳定判别定理

![image-20241029003155005](markdown-img/现控.assets/image-20241029003155005.png)

线性系统的Lyapunov稳定判定定理  

![image-20241029003306733](markdown-img/现控.assets/image-20241029003306733.png)

线性定常离散系统的渐进稳定判据  

![image-20241029003732320](markdown-img/现控.assets/image-20241029003732320.png)

克拉索夫斯基方法——渐进稳定的充分条件

![image-20241029003907315](markdown-img/现控.assets/image-20241029003907315.png)



#### 构造Lyapunov函数

![image-20241029003412717](markdown-img/现控.assets/image-20241029003412717.png)

找到正定的矩阵P、Q即可

![image-20241029003450587](markdown-img/现控.assets/image-20241029003450587.png)



## 非线性系统解的存在性、唯一性

Lipschitz条件，即利普希茨连续条件（Lipschitz continuity）

![image-20240915141847489](markdown-img/现控.assets/image-20240915141847489.png)

## 自治系统

[非线性与自适应控制（二）自治系统](https://zhuanlan.zhihu.com/p/343696219)

- 平衡点：**如果状态** $x∗$ **为系统的一个平衡点，那么一旦有** $x(t)=x∗$ **，则此后状态永远停留在** $x∗$ **上。即系统满足** $0=\dot {x}∗=f(x∗)$

- 稳定性

  ![image-20240915142441992](markdown-img/现控.assets/image-20240915142441992.png)

  ![v2-c37834715b8775346460e3d9d3245217_720w](markdown-img/现控.assets/v2-c37834715b8775346460e3d9d3245217_720w.webp)

  

### Lyapunov稳定性

注意，下面提到的Lyapunov稳定性，都是充分条件，而非必要条件。

![image-20240915142640058](markdown-img/现控.assets/image-20240915142640058.png)

![image-20240921113150491](markdown-img/现控.assets/image-20240921113150491.png)



![image-20240917201207639](markdown-img/现控.assets/image-20240917201207639.png)

![image-20240917201641674](markdown-img/现控.assets/image-20240917201641674.png)

example

![image-20240917202514538](markdown-img/现控.assets/image-20240917202514538.png)

自己找一个标量函数V，其倒数为$\dot{V}=\nabla{V}f(x)$

![image-20240917202756252](markdown-img/现控.assets/image-20240917202756252.png)

### 不变性原理

不变性原理， LaSalle's invariance principle。扩大了Lyapunov第二定理**渐进稳定**的应用范围——判断渐进稳定的三个条件
$$
V(x)\in{PD},\dot{V}(x)\in{NSD}
$$

$$
\dot{V}(x)=0当且仅当x=0
$$

![image-20240917203210121](markdown-img/现控.assets/image-20240917203210121.png)

## 非线性系统稳定性设计

【【Advanced控制理论】14_Nonlinear Basic Feedback Stabilization_非线性系统稳定性设计】https://www.bilibili.com/video/BV1uW411W7Wx?vd_source=93bb338120537438ee9180881deab9c1

![image-20240920110339306](markdown-img/现控.assets/image-20240920110339306.png)

反馈系统线性化，直接在输入消除非线性项，然后加上一个线性项（有点简单粗暴）

其它u也可，满足负定即可

![image-20240920110845998](markdown-img/现控.assets/image-20240920110845998.png)

在满足稳定性后寻找收敛速度最快的

## 非线性系统线性化

**求非线性模型平衡点处雅可比矩阵对其线性化**——思想：找平衡点，在平衡点附近泰勒展开，忽略高阶非线性项。即locally linearz





## 反馈线性化控制！

Nonlinear Backstepping Control\_反馈线性化控制_Feedback Linearization

以下方法称为反馈设计方法——反步法（exactly known system）

![image-20240920112512449](markdown-img/现控.assets/image-20240920112512449.png)

![9e3b0ac0713061ff701475ba82c3cf9](markdown-img/现控.assets/9e3b0ac0713061ff701475ba82c3cf9.jpg)







## 非线性自适应控制器

非线性自适应控制器Nonlinear Adaptive Controller

not exactly know system

![image-20240920121214109](markdown-img/现控.assets/image-20240920121214109.png)

if a is unknown, How?——we need to adapt the unknown parameter

令$\hat{a}$为估计值，我们的目标是let $\tilde{a}~and~ e\to0$，因此要寻找李式函数$V(e,\tilde{a})$

![image-20240920121936493](markdown-img/现控.assets/image-20240920121936493.png)

令$\dot{\hat{a}}=-ex^2$，于是$\dot{V}为NSD$

同样使用反步法，但在定义Lyapunov函数时加上$\frac{1}{2}\hat{a}^2$

![image-20240921114622391](markdown-img/现控.assets/image-20240921114622391.png)



## 鲁棒控制Robust Control



### 滑膜控制sliding mode

结论如下，注意u的形式，如此可以稳定

![image-20240921104102622](markdown-img/现控.assets/image-20240921104102622.png)

效果：

![image-20240921104742657](markdown-img/现控.assets/image-20240921104742657.png)

当直线偏离时，会拉回来

![image-20240921105533739](markdown-img/现控.assets/image-20240921105533739.png)

but可能会来回跳

证明如下：

![image-20240921104910797](markdown-img/现控.assets/image-20240921104910797.png)

![image-20240921104934740](markdown-img/现控.assets/image-20240921104934740.png)

![image-20240921105017193](markdown-img/现控.assets/image-20240921105017193.png)

![image-20240921105029361](markdown-img/现控.assets/image-20240921105029361.png)



### High Gain_High Frequency

![image-20240921105551088](markdown-img/现控.assets/image-20240921105551088.png)

![image-20240921105714326](markdown-img/现控.assets/image-20240921105714326.png)

> Hight Freq当$\epsilon\ne 0$相对于sliding mode切换更平缓

GUUB



### 三种控制比较

![image-20240921111810104](markdown-img/现控.assets/image-20240921111810104.png)

【【Advanced控制理论】19_三种鲁棒控制器的比较+如何分析控制器_Matlab Simulink】https://www.bilibili.com/video/BV1vW411V7Bh?p=25&vd_source=93bb338120537438ee9180881deab9c1

![image-20240921112323750](markdown-img/现控.assets/image-20240921112323750.png)



## 总结



# 做题

- 离散系统传函理解

  ![image-20241009132004865](markdown-img/现控.assets/image-20241009132004865.png)

  ![image-20241009132020258](markdown-img/现控.assets/image-20241009132020258.png)

  虽然可以利用一些其他手法来做（见上面），但是这是从s域最本质的理解

  > 其中**对C(s)离散化**是因为要对输出进行采样假设

- 去年一道考试题

  ![image-20241009132048390](markdown-img/现控.assets/image-20241009132048390.png)

  1. $\Phi(t)=e^{At}$，因此有$\dot{\Phi}(t)=Ae^{At}$，所以$\dot{\Phi}(0)=A$

  2. 直接按照定义进行判断即可

  3. 求解系统单位阶跃信号的输出，可见上面离散系统的状态空间模型

     要掌握连续和离散两种形式的求解

- 能控能观综合举例

  ![image-20241012082727881](markdown-img/现控.assets/image-20241012082727881.png)

  ![image-20241012082734389](markdown-img/现控.assets/image-20241012082734389.png)

  ![image-20241012082740832](markdown-img/现控.assets/image-20241012082740832.png)

- ![image-20241016091944650](markdown-img/现控.assets/image-20241016091944650-1729041584964-1.png)

  ![image-20241017095416120](markdown-img/现控.assets/image-20241017095416120.png)
  
  > 得到组合脉冲传函那一步是零阶保持器的特性
  
  ![image-20241017101132324](markdown-img/现控.assets/image-20241017101132324.png)
  
  ![image-20241017101609058](markdown-img/现控.assets/image-20241017101609058.png)
  
  ![image-20241017101626336](markdown-img/现控.assets/image-20241017101626336.png)

- 能控能观

  > 要说没有零极点相消，然后说明能控能观

  ![image-20241023091651404](markdown-img/现控.assets/image-20241023091651404.png)

  > 设计系统要写出最终的表达式

  ![image-20241023091841856](markdown-img/现控.assets/image-20241023091841856.png)

  ![image-20241023091902954](markdown-img/现控.assets/image-20241023091902954.png)

  ![image-20241023092010021](markdown-img/现控.assets/image-20241023092010021.png)

  ![image-20241023091928734](markdown-img/现控.assets/image-20241023091928734.png)

  ![image-20241023091950276](markdown-img/现控.assets/image-20241023091950276.png)

- 矩阵放大倍数$K$应该这样求

  ![image-20241023154239447](markdown-img/现控.assets/image-20241023154239447.png)

- 系统的动态响应性能计算也需要掌握！！！



# 期末

屋檐以怼:
状态观测器状态反馈器各一个大题

屋檐以怼:
李雅普诺夫一个大题

屋檐以怼:
开局是选择判断

屋檐以怼:
倒数第二题很难

疑似会考已知φ(t)怎么求A

屋檐以怼:
就是让你设计控制器但是不给你A

屋檐以怼:
给你φ(t)

屋檐以怼:
就那个e^At

四种继电特性会考一个选择

屋檐以怼:
倒数第二题会用自控原理的东西

屋檐以怼:
倒数第二题25分而且最难的是第一问。

屋檐以怼:
感觉有点阴间

屋檐以怼:
第八章以后考的内容非常少，疑似只有一个李雅普诺夫和一点选择

屋檐以怼:
降维状态观测器的目标极点会全给你一样的以免看出来观测几维。

屋檐以怼:
感觉有一个能算含参线性代数的计算器就win了

# References

- [DR_CAN【Advanced控制理论】](https://www.bilibili.com/video/BV1yx411u7iX?vd_source=93bb338120537438ee9180881deab9c1)

- [状态空间模型与传递函数的转换关系+例题_状态空间模型转化为传递函数](https://blog.csdn.net/sheagu/article/details/114310271)

- [典型环节的传递函数及其电路图-20151103_传递函数的基本环节的电路-CSDN博客](https://blog.csdn.net/zhaozhichenghpu/article/details/49706147)



# 附录

常用函数Z变换对照表

![image-20240911180818084](markdown-img/现控.assets/image-20240911180818084.png)

![v2-eb8c5a1d9d021da29cdde6936e1f7704_720w](markdown-img/现控.assets/v2-eb8c5a1d9d021da29cdde6936e1f7704_720w.webp)

![image-20241009090219708](markdown-img/现控.assets/image-20241009090219708.png)

> [广义特征向量计算方法_广义特征向量的求法-CSDN博客](https://blog.csdn.net/qq_42017767/article/details/108937706)求解广义特征向量
