# Main Takeaway

这节介绍《矩阵分析与应用》——第五章，奇异值分析

<!--more-->

# 奇异值分析

奇异值分解(singular value decomposition,SVD)已经是**数值线性代数**中最有用的工具之一

我们要先讨论奇异值是什么，有什么用

## 数值稳定性与条件数

- 在科学数据处理中，我们需要讨论数据处理和数值分析的算法稳定性

  在确定某个解的精度时，有两个不同的因素必须考虑：首先，若算法是稳定的，则 $  f^*(d)  $ 应该接近 $  f(d^*)  $；其次，若问题是良性的，则 $  f(d^*)  $ 应该接近 $  f(d)  $。这样，$  f^*(d)  $ 就会接近 $  f(d)  $。

- 条件数定义：对于方程$Ax=b$，如果系数矩阵或者系数向量发生微小扰动，我们需要利用条件数来描述矩阵$A$的数值特征
  $$
  \text{cond}(A) = \|A\|_2 \cdot \|A^{-1}\|_2
  $$
  式中，$ \text{cond}(A) $ 称为矩阵 $ A $ 的条件数，有时也用符号 $ \kappa(A) $ 表示。

  条件数刻画了求解线性方程时，误差经过矩阵 $  A  $ 的传播扩大为解向量的误差的程度，因此是衡量线性方程数值稳定性的一个重要指标。

  > 若条件数很大，称该线性方程问题（相对于范数$\|\cdot \|_2$）是病态的

在求解最小二乘时，我们通过推导可以知道：求解超定方程问题的QR分解方法具有比最小而成更好的数值稳定性（条件数更小），但是一种处理病态问题更好的方法时总体最小二乘法，基础是下面要介绍的SVD

## 奇异值分解

这里介绍了SVD的定义，性质，以及与矩阵一些其它数值指标的关系，还有其在秩亏缺最小二乘解的应用

- SVD定义：现在常将任意复厂房矩阵的奇异值分解称为utonee-Eckart-Young定理

  令 $  A \in \mathbb{R}^{m \times n}  $（或 $  \mathbb{C}^{m \times n}  $），则存在正交（或酉）矩阵 $  U \in \mathbb{R}^{m \times m}  $（或 $  \mathbb{C}^{m \times m}  $）和 $  V \in \mathbb{R}^{n \times n}  $（或 $  \mathbb{C}^{n \times n}  $）使得

  $$
  A = U \Sigma V^T \quad (\text{或 } U \Sigma V^H)
  $$
  式中 $  \Sigma = \begin{bmatrix} \Sigma_1 & O \\ O & O \end{bmatrix}  $，且 $  \Sigma_1 = \text{diag}(\sigma_1, \sigma_2, \cdots, \sigma_r)  $，其对角元素按照顺序

  $$
  \sigma_1 \geq \sigma_2 \geq \cdots \geq \sigma_r > 0, \quad r = \text{rank}(A)
  $$
  排列。

  数值 $  \sigma_1, \sigma_2, \cdots, \sigma_r  $ 连同 $  \sigma_{r+1} = \sigma_{r+2} = \cdots = \sigma_n = 0  $ 一起称作矩阵 $  A  $ 的奇异值。

- 单奇异值定义：矩阵 $  A_{m \times n}  $ 的奇异值 $  \sigma_i  $ 称为单奇异值，若 $  \sigma_i \neq \sigma_j, \, \forall \, j \neq i  $

- 下面给出SVD和奇异值的几点解释

  - 矩阵 $  A  $ 的奇异值分解式可以改写成向量表达形式

    $$
    A = \sum_{i=1}^{r} \sigma_i u_i v_i^H
    $$
    这种表达有时称为 $  A  $ 的并行向量（奇异值）分解（dyadic decomposition）。

  - 当矩阵 $  A  $ 的秩 $  r = \text{rank}(A) < \min\{m, n\}  $ 时，由于奇异值 $  \sigma_{r+1} = \cdots = \sigma_h = 0  $，$  h = \min\{m, n\}  $，故奇异值分解式 (5.2.3) 可以简化为

    $$
    A = U_r \Sigma_r V_r^H
    $$
    式中$$U_r = [u_1, \cdots, u_r], \quad V_r = [v_1, \cdots, v_r], \quad \Sigma_r = \text{diag}(\sigma_1, \cdots, \sigma_r)$$

    上式称为矩阵 $  A  $ 的截尾奇异值分解（truncated SVD）或薄奇异值分解（thin SVD）。与之形成对照，定义式则称为全奇异值分解（full SVD）。

  - 如果矩阵 $  A_{m \times n}  $ 具有秩 $  r  $，则：

    1. $  m \times m  $ 酉矩阵 $  U  $ 的前 $  r  $ 列组成矩阵 $  A  $ 的列空间的标准正交基。
    2. $  n \times n  $ 酉矩阵 $  V  $ 的前 $  r  $ 列组成矩阵 $  A  $ 的行空间或 $  A^H  $ 的列空间的标准正交基。
    3. $  V  $ 的后 $  n - r  $ 列组成矩阵 $  A  $ 的零空间的标准正交基。
    4. $  U  $ 的后 $  m - r  $ 列组成矩阵 $  A^H  $ 的零空间的标准正交基。

顾名思义，矩阵 $  A  $ 的奇异值应该能够描述 $  A  $ 的奇异性质。下面的定理从数学上严格地叙述了这一事实。

- 定理：令 $  A \in \mathbb{C}^{m \times n}  $（$  m \geq n  $）的奇异值为$$\sigma_1 \geq \cdots \geq \sigma_n \geq 0$$则
  $$
  \sigma_k = \min_{E \in \mathbb{C}^{m \times n}} \{ \|E\|_{\text{spec}} : \text{rank}(A + E) \leq k - 1 \}, \quad k = 1, \cdots, n
  $$
  并且存在一满足 $  \|E_k\|_{\text{spec}} = \sigma_k  $ 的误差矩阵 $  E  $ 使得
  $$
  \text{rank}(A + E_k) = k - 1, \quad k = 1, \cdots, n
  $$
  上述定理说明了矩阵$A$的奇异值与矩阵的秩亏损之间的关系，$\|E\|_{spec}$谱范数为$E$的最大奇异值，如果一个正方矩阵具有零奇异值，则该矩阵一定为奇异矩阵；而非正方矩阵零奇异值刻画了其行或列的秩亏缺，因此无论是正方还是长方矩阵，**零奇异值都刻画矩阵的奇异性**

- 奇异值的性质

  - 唯一性：非零奇异值的个数 $  r  $ 和它们的值 $  \sigma_1, \sigma_2, \cdots, \sigma_r  $ 相对于矩阵 $  A  $ 是唯一确定的。

  - 矩阵的各种变形与奇异值的变化有以下关系：

    1. $  m \times n  $ 矩阵 $  A  $ 的共轭转置 $  A^H  $ 的奇异值分解为
       $$
       A^H = V \Sigma^T U^H
       $$
       即矩阵 $  A  $ 和 $  A^H  $ 具有完全相同的奇异值。

    2. $  A^H A, \, A A^H  $ 的奇异值分解分别为
       $$
       A^H A = V \Sigma^T \Sigma V^H, \quad A A^H = U \Sigma \Sigma^T U^H
       $$
       其中

       $$
       \Sigma^T \Sigma = \text{diag}(\sigma_1^2, \sigma_2^2, \cdots, \sigma_r^2, \underbrace{0, \cdots, 0}_{n-r \text{个}}) \\
       \Sigma \Sigma^T = \text{diag}(\sigma_1^2, \sigma_2^2, \cdots, \sigma_r^2, \underbrace{0, \cdots, 0}_{m-r \text{个}})
       $$

    3. $P$ 和 $  Q  $ 分别为 $  m \times m  $ 和 $  n \times n  $ 酉矩阵时，$  PAQ^H  $ 的奇异值分解由

       $$
       PAQ^H = \tilde{U} \Sigma \tilde{V}^H
       $$
       给出，其中，$  \tilde{U} = PU, \, \tilde{V} = QV  $。也就是说，矩阵 $  PAQ^H  $ 与 $  A  $ 具有相同的奇异值，即奇异值具有酉不变性，但奇异向量不同。

    4. $m \times n$ 矩阵 $  A  $ 的奇异值分解与 $  n \times m  $ 维 Moore-Penrose 广义逆矩阵 $  A^\dagger  $ 之间存在下列关系
       $$
       A^\dagger = V \Sigma^\dagger U^H
       $$

       > 注意，$  \Sigma  $ 的广义逆矩阵 $  \Sigma^\dagger  $ 可直接计算为
       >
       > $$
       > \Sigma^\dagger = \begin{bmatrix} \Sigma^{-1} & O \\ O & O \end{bmatrix}
       > $$
       > 其中$$\Sigma^{-1} = \text{diag}\left(\frac{1}{\sigma_1}, \frac{1}{\sigma_2}, \cdots, \frac{1}{\sigma_r}\right)$$

       关于矩阵和它的子矩阵的奇异值之间的关系，有下面的定理，常被称为奇异值交织定理 (interlacing theorem for singular values)

    5. 定理：令 $  A  $ 是一个 $  m \times n  $ 矩阵，其奇异值 $  \sigma_1 \geq \cdots \geq \sigma_r  $，其中 $  r = \min\{m, n\}  $。若 $  p \times q  $ 矩阵 $  B  $ 是 $  A  $ 的子矩阵，其奇异值 $  \gamma_1 \geq \cdots \geq \gamma_{\min\{p, q\}}  $，则

       $$
       \sigma_i \geq \gamma_i, \quad i = 1, \cdots, \min\{p, q\}
       $$
       并且

       $$
       \gamma_i \geq \sigma_{i + (m - p) + (n - q)}, \quad i \leq \min\{p + q - m, p + q - n\}
       $$

    > Tips：当然SVD还有很多其它性质，详情见书

- 矩阵的奇异值与矩阵的范数、行列式、条件数、特征值等有着密切的关系。

  1. 奇异值与范数的关系

     矩阵 $  A  $ 的谱范数等于 $  A  $ 的最大奇异值，即

     $$
     \|A\|_{\text{spec}} = \sigma_1
     $$
     注意到矩阵 $  A  $ 的 Frobenius 范数 $  \|A\|_{\text{F}}  $ 是酉不变的，即 $  \|U^H A V\|_{\text{F}} = \|A\|_{\text{F}}  $，故有

     $$
     \|A\|_{\text{F}} = \left[ \sum_{i=1}^{m} \sum_{j=1}^{n} |a_{ij}|^2 \right]^{1/2} = \|U^H A V\|_{\text{F}} = \|\Sigma\|_{\text{F}} = \sqrt{\sigma_1^2 + \sigma_2^2 + \cdots + \sigma_r^2}
     $$
     即是说，任何一个矩阵的 Frobenius 范数等于该矩阵所有非零奇异值平方和的正平方根。

  2. 奇异值与行列式的关系

     设 $  A  $ 是 $  n \times n  $ 正方矩阵。由于酉矩阵的行列式之绝对值等于 1，所以由定理有

     $$
     |\det(A)| = |\det \Sigma| = \sigma_1 \sigma_2 \cdots \sigma_n
     $$
     若所有 $  \sigma_i  $ 都不等于零，则 $  |\det(A)| \neq 0  $，这表明 $  A  $ 是非奇异的。若至少有一个 $  \sigma_i (i > r)  $ 等于零，则 $  \det(A) = 0  $，即 $  A  $ 奇异。

     > 这就是之所以把全部 $  \sigma_i  $ 值统称为奇异值的原因。

  3. 奇异值与条件数的关系

     对于一个 $  m \times n  $ 矩阵 $  A  $，其条件数也可以利用奇异值定义为

     $$
     \text{cond}(A) = \frac{\sigma_1}{\sigma_p}, \quad p = \min\{m, n\}
     $$
     由定义可以看出，条件数是一个大于或等于 1 的正数，因为 $  \sigma_1 \geq \sigma_p  $。

     显然，由于至少有一个奇异值 $  \sigma_p = 0  $，故奇异矩阵的条件数虽然不是无穷大，但很大时，就称 $  A  $ 是**接近奇异**的。这意味着，当条件数很大时，$  A  $ 的行向量或列向量的线性相关性很强。

     又因为正交或酉矩阵 $  V  $ 的条件数等于 1。从这个意义上讲，正交或酉矩阵是“理想状态”的。上式也可用作条件数 $  \text{cond}(A)  $ 的评价。

     考虑超定方程 $  A^H A x = b  $。此时，由于 $  A^H A  $ 的奇异值分解为

     $$
     A^H A = V \Sigma^2 V^H
     $$
     即矩阵 $  A^H A  $ 的最大和最小奇异值分别是矩阵 $  A  $ 的最大和最小奇异值的平方，故

     $$
     \text{cond}(A^H A) = \frac{\sigma_1^2}{\sigma_n^2} = [\text{cond}(A)]^2
     $$
     即矩阵 $  A^H A  $ 的条件数是矩阵 $  A  $ 的条件数的平方倍。

  4. 奇异值与特征值的关系

     设 $  n \times n  $ 正方对称矩阵 $  A  $ 的特征值为 $  \lambda_1, \cdots, \lambda_n  $ ($ |\lambda_1| \geq \cdots \geq |\lambda_n| $)，奇异值为 $  \sigma_1, \cdots, \sigma_n  $ ($ \sigma_1 \geq \cdots \geq \sigma_n \geq 0 $)，则

     $$
     \sigma_1 \geq |\lambda_i| \geq \sigma_n \ (i = 1, \cdots, n), \quad \text{cond}(A) \geq \frac{|\lambda_1|}{|\lambda_n|}。
     $$

- 秩亏缺最小二乘解

  在奇异值分析的应用中，常常需要用一个低秩的矩阵逼近一个含噪声或扰动的矩阵。下面的定理给出了逼近质量的评价：

  - 定理：令 $  A \in \mathbb{R}^{m \times n}  $ 的奇异值分解由$$A = \sum_{i=1}^{p} \sigma_i u_i v_i^T$$给出，其中 $  p = \text{rank}(A)  $。若 $  k < p  $，并且$$A_k = \sum_{i=1}^{k} \sigma_i u_i v_i^T$$，则逼近质量可分别使用谱范数和 Frobenius 范数度量：
    $$
    \min_{\text{rank}(B) = k} \|A - B\|_{\text{spec}} = \|A - A_k\|_{\text{spec}} = \sigma_{k+1} \\
    \min_{\text{rank}(B) = k} \|A - B\|_{\text{F}} = \|A - A_k\|_{\text{F}} = \sqrt{\sum_{i=k+1}^{q} \sigma_i^2}
    $$
    式中，$  q = \min\{m, n\}  $

  在信号处理和系统理论中，最常见的线性方程组 $  A x = b  $ 是超定的和非满秩即秩亏的，也就是说，矩阵 $  A \in \mathbb{C}^{m \times n}  $ 的行数 $  m  $ 比列数 $  n  $ 大，且 $  r = \text{rank}(A) < n  $。令 $  A  $ 的奇异值分解由$$A = U \Sigma V^H$$给出，其中 $  \Sigma = \text{diag}(\sigma_1, \cdots, \sigma_r, 0, \cdots, 0)  $。考察$$G = V \Sigma^\dagger U^H$$

  式中，$  \Sigma^\dagger = \text{diag}(1/\sigma_1, \cdots, 1/\sigma_r, 0, \cdots, 0)  $。由奇异值的性质知，$  G  $ 是 $  A  $ 的 Moore-Penrose 广义逆矩阵。因此
  $$
  \hat{x} = G b = V \Sigma^\dagger U^H b
  $$
  或表示为

  $$
  x_{\text{LS}} = \sum_{i=1}^{r} \left( \frac{u_i^H b}{\sigma_i} \right) v_i
  $$
  它是最小二乘问题$$\min \|A x - b\|_2$$的最小范数解，相应的最小残差为

  $$
  \rho_{\text{LS}} = \|A x_{\text{LS}} - b\|_2 = \| [u_{r+1}, \cdots, u_m]^H b \|_2
  $$
  应用奇异值分解求解最小二乘问题的方法常简称为**奇异值分解方法**。

  虽然在理论上，当 $  i > r  $ 时奇异值 $  \sigma_i = 0  $，但是计算出来的奇异值 $  \hat{\sigma}_i, \, i > r  $ 并不会等于零，有时甚至表现出比较大的扰动。因此，需要有计算秩 $  r  $ 的估计值 $  \hat{r}  $ 的方法。在信号处理和系统理论中，常将该估计值称为**有效秩**。

  有效秩确定有以下两种常用方法：

  1. 归一化奇异值

     先计算归一化奇异值$\bar\sigma_i=\frac{\hat \sigma_i}{\hat \sigma_1}$，选择$\bar\sigma_i\ge \epsilon$的最大整数作为有效秩的估计值

  2. 范数比

  采用有效秩后，可以将其
  $$
  \hat{x}_{\text{LS}} = \sum_{i=1}^{\hat{r}} \left( \frac{\hat{u}_i^H b}{\hat{\sigma}_i} \right) \hat{v}_i
  $$
  看作是真实最小二乘解 $  x_{\text{LS}}  $ 的一个合理近似。显而易见，这种解就是方程组 $  A_{\hat{r}} x = b  $ 的最小二乘解，其中$$A_{\hat{r}} = \sum_{i=1}^{\hat{r}} \hat{\sigma}_i \hat{u}_i \hat{v}_i^H$$

  > 相当于过滤掉小的奇异值

## 乘积奇异值分解

接下来我们将介绍几种特殊情况下的矩阵的奇异值分解

## 奇异值分解的应用

## 广义奇异值分解

## 矩阵完备
